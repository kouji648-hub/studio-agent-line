<!DOCTYPE html>
<!--
ãƒ‘ã‚¿ãƒ¼ãƒ³B: ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãƒ™ãƒ¼ã‚¹ï¼ˆWhenå‹LINEãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆï¼‰
ãƒãƒ¼ã‚¸ãƒ§ãƒ³: v1.1ï¼ˆLINEæ”¹å–„æ¡ˆ_å®Œå…¨ç‰ˆã‚’åæ˜ ãƒ»æ–™é‡‘ä½“ç³»ä¿®æ­£ï¼‰
å®Ÿè£…æ—¥: 2026-02-12ï¼ˆä¿®æ­£: 2026-02-12ï¼‰
æ”¹å–„å†…å®¹: 60ç‚¹â†’100ç‚¹ã®å®Œå…¨æ”¹å–„ç‰ˆ
- åˆå›ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å·®åˆ¥åŒ–ãƒã‚¤ãƒ³ãƒˆå¼·èª¿ï¼ˆå¤§æ‰‹ã®åŠé¡ï¼‰
- ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªãƒ—ãƒ©ãƒ³: Â¥33,000ï¼ˆæœ€ã‚‚ãŠã™ã™ã‚ï¼‰
- ãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³(å‡ºå¼µ): Â¥40,000ï¼ˆä¸äººæ°—ã®Â¥19,000ã‹ã‚‰å¤‰æ›´ï¼‰
- FOMOå–šèµ·ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ 
- å…ˆè¡Œäºˆç´„ã®å®‰å¿ƒæ„Ÿã‚’å¼·èª¿ï¼ˆã‚»ãƒƒãƒˆå‰²å¼•ã§ã¯ãªãå…ˆè¡Œäºˆç´„ï¼‰
- è¨ªå•ç€å¯¾å¿œã‚’æ˜è¨˜
- ãƒãƒã®ä¸å®‰è§£æ¶ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
- ãƒªãƒã‚¤ãƒ³ãƒ‰æ©Ÿèƒ½å®Ÿè£…
- ç«¶åˆæ¯”è¼ƒãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¿½åŠ 
-->
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒ‘ã‚¿ãƒ¼ãƒ³B: ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãƒ™ãƒ¼ã‚¹ - hikarino studio LINE ãƒ‡ãƒ¢</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, 'Hiragino Sans', sans-serif; background: #7494C0; display: flex; justify-content: center; padding: 20px 10px; }
.phone { width: 390px; height: 844px; background: #fff; border-radius: 40px; overflow: hidden; box-shadow: 0 20px 60px rgba(0,0,0,0.3); display: flex; flex-direction: column; }
.header { background: #fff; padding: 50px 16px 12px; display: flex; align-items: center; gap: 12px; border-bottom: 1px solid #e5e5e5; flex-shrink: 0; }
.header .back { font-size: 24px; color: #06C755; cursor: pointer; }
.header .avatar { width: 40px; height: 40px; border-radius: 50%; background: #fff; display: flex; align-items: center; justify-content: center; color: #fff; font-size: 14px; font-weight: bold; overflow: hidden; }
.header .name { font-size: 16px; font-weight: 600; }
.header .badge { background: #06C755; color: #fff; font-size: 9px; padding: 2px 6px; border-radius: 8px; margin-left: 4px; }
.chat { flex: 1; overflow-y: auto; padding: 16px; display: flex; flex-direction: column; gap: 8px; background: #7494C0; }
.msg { max-width: 80%; animation: fadeIn 0.3s ease; }
.msg.bot { align-self: flex-start; }
.msg.user { align-self: flex-end; }
.msg .bubble { padding: 10px 14px; border-radius: 18px; font-size: 14px; line-height: 1.6; word-break: break-word; }
.msg.bot .bubble { background: #fff; color: #333; border-bottom-left-radius: 4px; }
.msg.user .bubble { background: #06C755; color: #fff; border-bottom-right-radius: 4px; }
.msg .time { font-size: 10px; color: rgba(255,255,255,0.7); margin-top: 2px; padding: 0 4px; }
.msg.bot .time { text-align: left; }
.msg.user .time { text-align: right; }
.choices { display: flex; flex-direction: column; gap: 8px; max-width: 85%; align-self: flex-start; animation: fadeIn 0.3s ease; }
.choices button { background: #fff; border: 2px solid #06C755; color: #06C755; padding: 12px 20px; border-radius: 24px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; text-align: left; }
.choices button:hover { background: #06C755; color: #fff; }
.choices button:active { transform: scale(0.97); }
.rich-msg { max-width: 85%; align-self: flex-start; background: #fff; border-radius: 14px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08); animation: fadeIn 0.3s ease; flex-shrink: 0; }
.rich-msg .rich-header { padding: 16px; color: #fff; }
.rich-msg .rich-body { padding: 14px; }
.rich-msg .rich-body .feat { display: flex; align-items: center; gap: 8px; padding: 6px 0; font-size: 13px; color: #555; }
.rich-msg .rich-body .feat::before { content: "âœ“"; color: #06C755; font-weight: bold; font-size: 16px; }
.rich-msg .urgency { background: #fff3e0; padding: 10px 14px; font-size: 12px; color: #e65100; font-weight: 500; border-top: 1px solid #ffe0b2; display: flex; align-items: center; gap: 6px; }
.rich-msg .social-proof { background: #fff9fb; padding: 10px 14px; font-size: 12px; color: #ff6b9d; font-weight: 500; border-top: 1px solid #ffeef5; }
.rich-msg .cta-row { display: flex; border-top: 1px solid #eee; }
.rich-msg .cta-row button { flex: 1; padding: 12px; border: none; font-size: 13px; font-weight: 600; cursor: pointer; transition: background 0.2s; }
.rich-msg .cta-row .cta-primary { background: #06C755; color: #fff; }
.rich-msg .cta-row .cta-primary:hover { background: #05b04c; }
.rich-msg .cta-row .cta-secondary { background: #fff; color: #06C755; }
.rich-msg .cta-row .cta-secondary:hover { background: #f0faf4; }
.timeline { max-width: 85%; align-self: flex-start; background: #fff; border-radius: 14px; padding: 16px; animation: fadeIn 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
.timeline h4 { font-size: 14px; color: #333; margin-bottom: 12px; }
.timeline .tl-item { display: flex; gap: 12px; padding: 8px 0; }
.timeline .tl-dot { width: 12px; height: 12px; border-radius: 50%; margin-top: 4px; flex-shrink: 0; }
.timeline .tl-dot.active { background: #ff6b9d; box-shadow: 0 0 0 4px #ffeef5; }
.timeline .tl-dot.future { background: #ddd; }
.timeline .tl-content { flex: 1; }
.timeline .tl-content .tl-title { font-size: 13px; font-weight: 600; color: #333; }
.timeline .tl-content .tl-desc { font-size: 11px; color: #888; margin-top: 2px; }
.timeline .tl-content .tl-highlight { font-size: 12px; color: #ff6b9d; font-weight: 500; margin-top: 4px; }
.bundle-msg { max-width: 85%; align-self: flex-start; background: #fff; border-radius: 14px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.08); animation: fadeIn 0.3s ease; }
.bundle-msg .bundle-header { background: linear-gradient(135deg, #ff6b9d, #c06bc7); padding: 14px 16px; color: #fff; }
.bundle-msg .bundle-header h4 { font-size: 14px; }
.bundle-msg .bundle-header .bundle-tag { display: inline-block; background: rgba(255,255,255,0.25); padding: 2px 8px; border-radius: 10px; font-size: 10px; margin-top: 4px; }
.bundle-msg .bundle-body { padding: 14px; }
.bundle-msg .bundle-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid #f5f5f5; }
.bundle-msg .bundle-item:last-child { border-bottom: none; }
.bundle-msg .bundle-item .bi-name { font-size: 13px; color: #333; }
.bundle-msg .bundle-item .bi-price { font-size: 13px; color: #999; text-decoration: line-through; }
.bundle-msg .bundle-total { background: #fff9fb; padding: 12px 14px; display: flex; justify-content: space-between; align-items: center; }
.bundle-msg .bundle-total .bt-label { font-size: 13px; color: #666; }
.bundle-msg .bundle-total .bt-price { font-size: 20px; font-weight: 700; color: #ff6b9d; }
.step-indicator { text-align: center; padding: 8px; font-size: 11px; color: rgba(255,255,255,0.7); }
.typing { align-self: flex-start; animation: fadeIn 0.3s ease; }
.typing .bubble { background: #fff; border-radius: 18px; border-bottom-left-radius: 4px; padding: 12px 18px; display: flex; gap: 4px; }
.typing .dot { width: 8px; height: 8px; background: #ccc; border-radius: 50%; animation: typingDot 1.4s infinite; }
.typing .dot:nth-child(2) { animation-delay: 0.2s; }
.typing .dot:nth-child(3) { animation-delay: 0.4s; }
.input-bar { background: #fff; padding: 8px 12px 30px; display: flex; align-items: center; gap: 8px; border-top: 1px solid #e5e5e5; flex-shrink: 0; }
.input-bar input { flex: 1; padding: 10px 16px; border: 1px solid #ddd; border-radius: 20px; font-size: 14px; outline: none; }
.input-bar .send { width: 36px; height: 36px; background: #06C755; border: none; border-radius: 50%; color: #fff; font-size: 18px; cursor: pointer; }
.debug-bar { background: #333; color: #aaa; padding: 8px 16px; font-size: 11px; display: flex; justify-content: space-between; flex-shrink: 0; }
.debug-bar .reset { color: #ff6b6b; cursor: pointer; text-decoration: underline; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
@keyframes typingDot { 0%, 60%, 100% { transform: translateY(0); } 30% { transform: translateY(-6px); } }
.image-gallery { max-width: 90%; align-self: flex-start; animation: fadeIn 0.3s ease; margin: 8px 0; }
.image-gallery .gallery-scroll { display: flex; gap: 8px; overflow-x: auto; scroll-snap-type: x mandatory; padding: 4px 0; -webkit-overflow-scrolling: touch; scrollbar-width: none; }
.image-gallery .gallery-scroll::-webkit-scrollbar { display: none; }
.image-gallery .gallery-scroll img { flex-shrink: 0; width: 280px; height: auto; border-radius: 12px; scroll-snap-align: start; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.2s; }
.image-gallery .gallery-scroll img:hover { transform: scale(1.02); }
.image-gallery .gallery-indicator { text-align: center; font-size: 11px; color: #999; margin-top: 8px; }
</style>
</head>
<body>
<div class="phone">
  <div class="header">
    <span class="back">&lsaquo;</span>
    <div class="avatar">
      <img src="https://hikarinostudio.com/wp-content/uploads/2019/09/IMG_2478.png" alt="hikarino studio" style="width:100%;height:100%;object-fit:cover;">
    </div>
    <div>
      <span class="name">hikarino studio</span>
      <span class="badge">å…¬å¼</span>
    </div>
  </div>
  <div class="chat" id="chat"></div>
  <div class="input-bar">
    <input type="text" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›" disabled>
    <button class="send">&#9654;</button>
  </div>
  <div class="debug-bar">
    <span>ãƒ‘ã‚¿ãƒ¼ãƒ³B: ã‚¿ã‚¤ãƒŸãƒ³ã‚°ãƒ™ãƒ¼ã‚¹ï¼ˆWhenå‹ï¼‰â˜…æ¨å¥¨</span>
    <span class="reset" onclick="resetFlow()">ãƒªã‚»ãƒƒãƒˆ</span>
  </div>
</div>

<script>
const chat = document.getElementById('chat');

function addMsg(type, text, delay) {
  return new Promise(resolve => {
    // \n ã‚’ <br> ã«å¤‰æ›
    const formattedText = text.replace(/\n/g, '<br>');

    if (type === 'bot') {
      const typing = document.createElement('div');
      typing.className = 'typing';
      typing.innerHTML = '<div class="bubble"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>';
      chat.appendChild(typing);
      scrollDown();
      setTimeout(() => {
        typing.remove();
        const div = document.createElement('div');
        div.className = 'msg bot';
        div.innerHTML = `<div class="bubble">${formattedText}</div><div class="time">${getTime()}</div>`;
        chat.appendChild(div);
        scrollDown();
        resolve();
      }, delay || 800);
    } else {
      const div = document.createElement('div');
      div.className = 'msg user';
      div.innerHTML = `<div class="bubble">${formattedText}</div><div class="time">${getTime()}</div>`;
      chat.appendChild(div);
      scrollDown();
      setTimeout(resolve, 300);
    }
  });
}

function addChoices(options, callback) {
  const div = document.createElement('div');
  div.className = 'choices';
  options.forEach(opt => {
    const btn = document.createElement('button');
    btn.textContent = opt.label;
    btn.onclick = () => { div.remove(); addMsg('user', opt.label).then(() => callback(opt.value)); };
    div.appendChild(btn);
  });
  chat.appendChild(div);
  scrollDown();
}

function addTimeline(items) {
  const div = document.createElement('div');
  div.className = 'timeline';
  div.innerHTML = `<h4>ğŸ“… ãŠå­æ§˜ã®æˆé•·ã¨æ’®å½±ã‚¿ã‚¤ãƒŸãƒ³ã‚°</h4>` +
    items.map(item => `
      <div class="tl-item">
        <div class="tl-dot ${item.active ? 'active' : 'future'}"></div>
        <div class="tl-content">
          <div class="tl-title">${item.title}</div>
          <div class="tl-desc">${item.desc}</div>
          ${item.highlight ? `<div class="tl-highlight">${item.highlight}</div>` : ''}
        </div>
      </div>
    `).join('');
  chat.appendChild(div);
  scrollDown();
}

function addRichMsg(config) {
  const div = document.createElement('div');
  div.className = 'rich-msg';
  div.innerHTML = `
    <div class="rich-header" style="background: ${config.gradient}">
      <h3>${config.title}</h3>
      <p>${config.subtitle}</p>
    </div>
    <div class="rich-body">
      ${config.features.map(f => `<div class="feat">${f}</div>`).join('')}
    </div>
    ${config.urgency ? `<div class="urgency">â° ${config.urgency}</div>` : ''}
    ${config.proof ? `<div class="social-proof">${config.proof}</div>` : ''}
    <div class="cta-row">
      <button class="cta-primary" onclick="handleCTA('reservation')">äºˆç´„ã¯ã“ã¡ã‚‰</button>
      <button class="cta-secondary" onclick="handleCTA('consult')">LINEã§ç›¸è«‡</button>
    </div>
  `;
  chat.appendChild(div);
  scrollDown();
}

function addBundleMsg(config) {
  const div = document.createElement('div');
  div.className = 'bundle-msg';
  div.innerHTML = `
    <div class="bundle-header">
      <h4>${config.title}</h4>
      <span class="bundle-tag">${config.tag}</span>
    </div>
    <div class="bundle-body">
      ${config.items.map(item => `
        <div class="bundle-item">
          <span class="bi-name">${item.name}</span>
          <span class="bi-price">${item.originalPrice}</span>
        </div>
      `).join('')}
    </div>
    <div class="bundle-total">
      <span class="bt-label">ã‚»ãƒƒãƒˆä¾¡æ ¼</span>
      <span class="bt-price">&yen;${config.totalPrice}<small>ï¼ˆç¨åˆ¥ï¼‰</small></span>
    </div>
    <div class="cta-row" style="border-top: 1px solid #eee;">
      <button class="cta-primary" style="background:#ff6b9d;" onclick="handleCTA('reservation')">ã“ã®ãƒ—ãƒ©ãƒ³ã§äºˆç´„</button>
      <button class="cta-secondary" onclick="handleCTA('consult')">ç›¸è«‡ã™ã‚‹</button>
    </div>
  `;
  chat.appendChild(div);
  scrollDown();
}

function addStepIndicator(text) {
  const div = document.createElement('div');
  div.className = 'step-indicator';
  div.textContent = text;
  chat.appendChild(div);
  scrollDown();
}

// ç”»åƒè¡¨ç¤ºãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
function addImageMsg(src, alt, caption) {
  const div = document.createElement('div');
  div.className = 'msg bot';
  div.innerHTML = `
    <div class="bubble" style="padding:4px !important;max-width:250px;">
      <img src="${src}" alt="${alt}" style="width:100%;border-radius:8px;display:block;" loading="lazy">
      ${caption ? `<p style="margin:8px 0 0;font-size:12px;color:#666;">${caption}</p>` : ''}
    </div>
    <div class="time">${getTime()}</div>
  `;
  chat.appendChild(div);
  scrollDown();
}

// ç”»åƒã‚®ãƒ£ãƒ©ãƒªãƒ¼ï¼ˆæ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ï¼‰
function addImageGallery(images, label) {
  const div = document.createElement('div');
  div.className = 'image-gallery';

  const imagesHTML = images.map(img =>
    `<img src="${img.src}" alt="${img.alt}" loading="lazy">`
  ).join('');

  div.innerHTML = `
    <div class="gallery-scroll">${imagesHTML}</div>
    ${label ? `<div class="gallery-indicator">${label}</div>` : ''}
  `;

  chat.appendChild(div);

  // ã‚®ãƒ£ãƒ©ãƒªãƒ¼è¡¨ç¤ºä¸­ã¯è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’ä¸€æ™‚åœæ­¢
  pauseAutoScroll = true;

  // ã‚®ãƒ£ãƒ©ãƒªãƒ¼ãŒè¦‹ãˆã‚‹ä½ç½®ã¾ã§ã‚¹ãƒ ãƒ¼ã‚ºã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
  setTimeout(() => {
    div.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'nearest' });

    // 2ç§’å¾Œã«è‡ªå‹•ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚’å†é–‹ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚®ãƒ£ãƒ©ãƒªãƒ¼ã‚’è¦‹ã‚‹æ™‚é–“ï¼‰
    setTimeout(() => {
      pauseAutoScroll = false;
    }, 2000);
  }, 100);
}

// Instagramã‚«ãƒ¼ãƒ‰ï¼ˆã‚¯ãƒªãƒƒã‚«ãƒ–ãƒ«ï¼‰
function addInstagramCard(accountName, displayName, qrImagePath, instagramUrl) {
  const div = document.createElement('div');
  div.className = 'rich-msg';

  div.innerHTML = `
    <div class="rich-header" style="background: linear-gradient(135deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);">
      <h3 style="font-size: 15px; margin: 0;">ğŸ“¸ Instagram</h3>
      <p style="font-size: 13px; opacity: 0.9; margin: 4px 0 0;">${displayName}</p>
    </div>
    <a href="${instagramUrl}" target="_blank" style="display: block; text-decoration: none; cursor: pointer; transition: opacity 0.2s;"
       onmouseover="this.style.opacity='0.9'"
       onmouseout="this.style.opacity='1'">
      <img src="${qrImagePath}" alt="${accountName}"
           style="width: 100%; display: block; background: #fff;">
      <div style="padding: 14px; background: #fff; text-align: center; border-top: 1px solid #f0f0f0;">
        <div style="color: #06C755; font-weight: 600; font-size: 14px;">
          ğŸ‘† ã‚¿ãƒƒãƒ—ã—ã¦ ${accountName} ã‚’ãƒ•ã‚©ãƒ­ãƒ¼
        </div>
      </div>
    </a>
  `;

  chat.appendChild(div);
  scrollDown();
}

// æ¨ªã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã‚®ãƒ£ãƒ©ãƒªãƒ¼ï¼ˆè¤‡æ•°ç”»åƒï¼‰
function addPhotoGallery(photos) {
  const div = document.createElement('div');
  div.style.cssText = 'display:flex;gap:10px;overflow-x:auto;padding:4px 0 8px;max-width:100%;align-self:flex-start;scroll-snap-type:x mandatory;-webkit-overflow-scrolling:touch;';

  photos.forEach(photo => {
    const img = document.createElement('div');
    img.style.cssText = 'min-width:200px;max-width:200px;flex-shrink:0;scroll-snap-align:start;';
    img.innerHTML = `<img src="${photo.url}" alt="${photo.alt}" style="width:100%;height:auto;border-radius:8px;display:block;" loading="lazy">`;
    div.appendChild(img);
  });

  chat.appendChild(div);
  scrollDown();
}

// ã‚¹ã‚¿ã‚¸ã‚ªæ¯”è¼ƒè¡¨ç¤º
function addStudioComparison() {
  const div = document.createElement('div');
  div.className = 'msg bot';
  div.innerHTML = `
    <div class="bubble" style="padding:0;border-radius:8px;overflow:hidden;">
      <div style="background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,0.08);">
        <h4 style="padding:12px 16px;margin:0;font-size:14px;color:#333;">ğŸ“ 2ã¤ã®ã‚¹ã‚¿ã‚¸ã‚ª</h4>
        <div style="background:linear-gradient(135deg, #f8bbd0, #f48fb1);padding:12px 16px;color:#fff;">
          <h5 style="margin:0 0 4px;font-size:14px;">ğŸŒ¸ ä¸‹åŒ—æ–¹ã‚¹ã‚¿ã‚¸ã‚ª</h5>
          <span style="font-size:12px;opacity:0.9;">å®®å´å¸‚</span>
        </div>
        <img src="https://hikarinostudio.com/wp-content/uploads/2022/04/1.png" alt="ä¸‹åŒ—æ–¹ã‚¹ã‚¿ã‚¸ã‚ªå¤–è¦³" style="width:100%;height:auto;display:block;" loading="lazy">
        <div style="padding:12px 16px;font-size:13px;color:#555;">
          <p style="margin:0 0 8px;line-height:1.5;">è¤‡æ•°ã®æ’®å½±ãƒ«ãƒ¼ãƒ ï¼‹ç·‘ã‚ãµã‚Œã‚‹ãŠåº­</p>
          <div style="display:flex;flex-wrap:wrap;gap:4px;margin:8px 0;">
            <span style="background:#f5f5f5;padding:4px 8px;border-radius:12px;font-size:11px;">ğŸŒ¸ SAKURAÃ—Antique</span>
            <span style="background:#f5f5f5;padding:4px 8px;border-radius:12px;font-size:11px;">â˜€ï¸ Natural light</span>
            <span style="background:#f5f5f5;padding:4px 8px;border-radius:12px;font-size:11px;">â­ Starry sky</span>
            <span style="background:#f5f5f5;padding:4px 8px;border-radius:12px;font-size:11px;">ğŸŒº Flower cafe</span>
          </div>
          <p style="margin:8px 0 0;font-size:12px;color:#666;">â›© å®®å´ç¥å®®ï¼ˆè»Š5åˆ†ï¼‰</p>
        </div>
        <div style="border-top:1px solid #f5f5f5;background:linear-gradient(135deg, #d7ccc8, #bcaaa4);padding:12px 16px;color:#fff;">
          <h5 style="margin:0 0 4px;font-size:14px;">ğŸ› éƒ½åŸã‚¹ã‚¿ã‚¸ã‚ª</h5>
          <span style="font-size:12px;opacity:0.9;">éƒ½åŸå¸‚</span>
        </div>
        <img src="https://hikarinostudio.com/wp-content/uploads/2023/06/16.png" alt="éƒ½åŸã‚¹ã‚¿ã‚¸ã‚ªå†…è£…" style="width:100%;height:auto;display:block;" loading="lazy">
        <div style="padding:12px 16px;font-size:13px;color:#555;">
          <p style="margin:0 0 8px;line-height:1.5;">100å¹´å‰ã®ã‚¢ãƒ³ãƒ†ã‚£ãƒ¼ã‚¯å®¶å…·Ã—ãƒ¯ãƒ³ãƒˆãƒ¼ãƒ³ç©ºé–“</p>
          <div style="display:flex;flex-wrap:wrap;gap:4px;margin:8px 0;">
            <span style="background:#f5f5f5;padding:4px 8px;border-radius:12px;font-size:11px;">ğŸª‘ Antique</span>
            <span style="background:#f5f5f5;padding:4px 8px;border-radius:12px;font-size:11px;">ğŸ¤ White tone</span>
          </div>
          <p style="margin:8px 0 0;font-size:12px;color:#666;">â›© ç¥æŸ±å®®ï¼ˆè»Š5åˆ†ï¼‰</p>
        </div>
      </div>
    </div>
    <div class="time">${getTime()}</div>
  `;
  chat.appendChild(div);
  scrollDown();
}

// å…„å¼Ÿè¡£è£…è¨´æ±‚
async function addSiblingAppeal() {
  await addMsg('bot', `ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å…„å¼Ÿãƒ»å§‰å¦¹ãŒã„ã‚‹ãƒãƒã¸
ã€ç„¡æ–™ã§å«ã¾ã‚Œã‚‹ã‚‚ã®ã€‘
â­ å…„å¼Ÿã®è¡£è£…1ç€ãƒ¬ãƒ³ã‚¿ãƒ«
â­ å®¶æ—ã¨å…„å¼Ÿã®ä¸€ç·’ã®ã‚«ãƒƒãƒˆ
ã€ã‚‚ã£ã¨æ®‹ã—ãŸã„ãªã‚‰ã€‘
ğŸ“¸ å…„å¼Ÿã‚½ãƒ­ã‚«ãƒƒãƒˆæœ‰ã‚Šã‚ªãƒ—ã‚·ãƒ§ãƒ³
ã€€+Â¥16,500ï¼ˆè¡£è£…2ç‚¹ãƒ»10ã‚«ãƒƒãƒˆè¿½åŠ ï¼‰`, 600);
}

// ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³æ’®å½±å¾Œã®ã‚¹ã‚¿ã‚¸ã‚ªæƒ…å ±
async function sendNewbornStudioInfo() {
  await addMsg('bot', 'ğŸ“¸ ã‚¹ã‚¿ã‚¸ã‚ªã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ã”è¦§ãã ã•ã„');
  addImageMsg('https://hikarinostudio.com/wp-content/uploads/2021/11/DDD01523-Edit.jpg', 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³æ’®å½±ã‚¹ã‚¿ã‚¸ã‚ª');
  await addMsg('bot', `ğŸ“… äºˆç´„ã¯ã“ã¡ã‚‰
https://docs.google.com/forms/d/e/1FAIpQLSc3SmhZFUmUb6jigSCQk-oGw8i1wa_nVB4DQSoYre_lqreunQ/viewform

ğŸ’¡ ä»®äºˆç´„ã‚‚OKï¼å‡ºç”£å¾Œã«æ—¥ç¨‹èª¿æ•´ã§ãã¾ã™`);
  await addMsg('bot', `ğŸ“ æ’®å½±å ´æ‰€ã®ã”æ¡ˆå†…

ã€å®®å´å¸‚ã«ãŠä½ã¾ã„ã®æ–¹ã€‘
ä¸‹åŒ—æ–¹ã‚¹ã‚¿ã‚¸ã‚ªã¸ãŠæ°—è»½ã«ã”æ¥åº—ãã ã•ã„

ã€éƒ½åŸå¸‚ã«ãŠä½ã¾ã„ã®æ–¹ã€‘
éƒ½åŸã‚¹ã‚¿ã‚¸ã‚ªãŒä¾¿åˆ©ã§ã™`);
}

// ãƒ•ãƒ­ãƒ¼çµ‚äº†æ™‚ã®æœ€çµ‚è¡¨ç¤º
async function finalizeFlow() {
  await addMsg('bot', 'ğŸ“¸ ã‚¹ã‚¿ã‚¸ã‚ªã®é›°å›²æ°—ã‚’ã”è¦§ãã ã•ã„');
  addImageMsg('https://hikarinostudio.com/wp-content/uploads/2024/01/studio-main.jpg', 'hikarino studio');

  await addMsg('bot', `ğŸ”— ã”ä¸æ˜ãªç‚¹ã¯ã“ã¡ã‚‰ã‚’ã”è¦§ãã ã•ã„

ğŸ“ å…¬å¼HP: https://hikarinostudio.com/
ğŸ‘¶ ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³äºˆç´„ï¼ˆ60ç§’ã§å®Œäº†ï¼‰: https://bit.ly/3GSS8c
ğŸ“¸ Instagram: https://www.instagram.com/hikarino_studio?igsh=OXZrMzd5aWF6emhv&utm_source=qr
â›©ï¸ ãŠå®®å‚ã‚Šè©³ç´°: https://hikarinostudio.com/omiyamairi/`);

  addChoices([
    { label: 'ğŸ—“ï¸ äºˆç´„ã™ã‚‹', value: 'reserve' },
    { label: 'ğŸ’¬ ç›¸è«‡ã™ã‚‹', value: 'consult' }
  ], async (finalAction) => {
    if (finalAction === 'reserve') {
      await addMsg('bot', `ğŸ“… ä»Šã™ãäºˆç´„ã™ã‚‹ï¼ˆ60ç§’ã§å®Œäº†ï¼‰
https://bit.ly/3GSS8c

ğŸ’¡ ä»®äºˆç´„ã‚‚OKï¼å‡ºç”£å¾Œã«æ—¥ç¨‹èª¿æ•´ã§ãã¾ã™`);
    } else {
      await addMsg('bot', 'ã”è³ªå•ãƒ»ã”ç›¸è«‡ã¯LINEã§ãŠæ°—è»½ã«ã©ã†ãğŸ’\nã‚¹ã‚¿ãƒƒãƒ•ãŒä¸å¯§ã«ãŠç­”ãˆã—ã¾ã™ã€‚');
    }
  });
}

let pauseAutoScroll = false;

function scrollDown() {
  if (pauseAutoScroll) return;
  setTimeout(() => {
    chat.scrollTo({ top: chat.scrollHeight, behavior: 'smooth' });
  }, 50);
}
function getTime() { const n = new Date(); return `${n.getHours()}:${String(n.getMinutes()).padStart(2, '0')}`; }

// === FLOW ===

async function startFlow() {
  addStepIndicator('â€” Step 1: ãŠå­æ§˜ã®çŠ¶æ³ã‚’æŠŠæ¡ â€”');
  await addMsg('bot', `hikarino studioå…¬å¼LINEã¸ã‚ˆã†ã“ã!ğŸ‘¶

ã€å¹´é–“500çµ„ä»¥ä¸Šã®ãƒãƒã«é¸ã°ã‚Œã¦ã„ã¾ã™ã€‘

âœ“ å®Œå…¨è²¸åˆ‡ã§æˆä¹³ãƒ»ãŠã‚€ã¤æ›¿ãˆã‚‚å®‰å¿ƒ
âœ“ æ–™é‡‘æ˜æœ—ãƒ»å¤§æ‰‹ã®åŠé¡
âœ“ ãƒ‡ãƒ¼ã‚¿50ã€œ60æšæ¨™æº–ä»˜å±
âœ“ è¡£è£…ãƒ»å°ç‰©ã™ã¹ã¦ç„¡æ–™

ãŠå­æ§˜ã®ä»Šã®çŠ¶æ³ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚
30ç§’ã§æœ€é©ãƒ—ãƒ©ãƒ³ãŒã‚ã‹ã‚Šã¾ã™ğŸ’`);

  addChoices([
    { label: 'ğŸ¤° å¦Šå¨ ä¸­ã§ã™', value: 'pregnant' },
    { label: 'ğŸ‘¶ ç”Ÿå¾Œ1ãƒ¶æœˆä»¥å†…', value: 'newborn' },
    { label: 'ğŸ‘§ åŠå¹´ã€œ2æ­³', value: 'toddler' },
    { label: 'ğŸ§’ 3ã€œ7æ­³', value: 'child' },
    { label: 'ğŸ“· ãã®ä»–ã®æ’®å½±', value: 'other' }
  ], handleTiming);
}

async function handleTiming(timing) {
  switch(timing) {
    case 'pregnant': return flowPregnant();
    case 'newborn': return flowNewborn();
    case 'toddler': return flowToddler();
    case 'child': return flowChild();
    case 'other': return flowOther();
  }
}

// --- å¦Šå¨ ä¸­ãƒ•ãƒ­ãƒ¼ ---
async function flowPregnant() {
  addStepIndicator('â€” Step 2: å¦Šå¨ ä¸­ã®ãƒãƒã¸ â€”');

  await addMsg('bot', 'ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼\n\nå‡ºç”£å¾Œã®æ’®å½±ã‚’ä»Šã‹ã‚‰æº–å‚™ã—ã¦ãŠãã¨å®‰å¿ƒã§ã™ã€‚');

  addTimeline([
    { title: 'å¦Šå¨ ä¸­ï¼ˆä»Šï¼‰', desc: 'ãƒã‚¿ãƒ‹ãƒ†ã‚£ãƒ•ã‚©ãƒˆæ’®å½±ã‚‚å¯èƒ½', active: true, highlight: 'â†’ ä»Šãªã‚‰ä½™è£•ã‚’ã‚‚ã£ã¦æº–å‚™ã§ãã¾ã™' },
    { title: 'ç”Ÿå¾Œ7ã€œ21æ—¥', desc: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³æ’®å½±ã®æœ€é©æœŸé–“', active: false, highlight: 'â†’ ã“ã®æœŸé–“ã‚’é€ƒã™ã¨æ–°ç”Ÿå…ã‚‰ã—ã„ãƒãƒ¼ã‚ºãŒé›£ã—ããªã‚Šã¾ã™' },
    { title: 'ç”Ÿå¾Œ1ãƒ¶æœˆ', desc: 'ãŠå®®å‚ã‚Šæ’®å½±', active: false },
    { title: '1æ­³', desc: 'ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆãƒãƒ¼ã‚¹ãƒ‡ãƒ¼', active: false }
  ]);

  await new Promise(r => setTimeout(r, 1500));

  await addMsg('bot', `ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³æ’®å½±ã®ãƒ™ã‚¹ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¯ç”Ÿå¾Œ7~21æ—¥ã€‚
ã“ã®æ™‚æœŸã‚’é€ƒã™ã¨:
âŒ é–¢ç¯€ãŒç¡¬ããªã‚Šã€ä¸¸ã¾ã£ãŸãƒãƒ¼ã‚ºãŒé›£ã—ã„
âŒ èµ·ãã¦ã„ã‚‹æ™‚é–“ãŒå¢—ãˆã¦æ’®å½±ãŒå¤§å¤‰ã«
ã§ã‚‚å¤§ä¸ˆå¤«!
âœ“ å¦Šå¨ ä¸­ã«ä»®äºˆç´„â†’å‡ºç”£å¾Œã«æ—¥ç¨‹èª¿æ•´
âœ“ äºˆå®šæ—¥ã®å‰å¾Œã«æŸ”è»Ÿå¯¾å¿œ
âœ“ å‡ºç”£å ±å‘Šã‚’å¾…ã£ã¦ã‹ã‚‰æ­£å¼äºˆç´„
ä»Šãªã‚‰ä½™è£•ã‚’ã‚‚ã£ã¦æº–å‚™ã§ãã¾ã™ğŸ¤°`, 800);

  await addMsg('bot', `èµ¤ã¡ã‚ƒã‚“ã®ç§»å‹•è² æ‹…ã‚’è€ƒæ…®ã—ã¦
ã”è‡ªå®…ã«è¿‘ã„ã‚¹ã‚¿ã‚¸ã‚ªãŒãŠã™ã™ã‚ã§ã™ğŸ 
ğŸ“ å®®å´å¸‚ã«ãŠä½ã¾ã„ãªã‚‰ â†’ ä¸‹åŒ—æ–¹ã‚¹ã‚¿ã‚¸ã‚ª
ğŸ“ éƒ½åŸå¸‚ã«ãŠä½ã¾ã„ãªã‚‰ â†’ éƒ½åŸã‚¹ã‚¿ã‚¸ã‚ª
ğŸ“ ã©ã¡ã‚‰ã‚‚é ã„å ´åˆã¯ â†’ å‡ºå¼µæ’®å½±ãŒãŠã™ã™ã‚`, 600);

  addStudioComparison();
  await new Promise(r => setTimeout(r, 1200));

  await addMsg('bot', `ğŸ å…ˆè¡Œäºˆç´„ã§å®‰å¿ƒ!
ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã¨ãŠå®®å‚ã‚Šã®å…ˆè¡Œäºˆç´„ã§
ç”£å¾Œã®ãƒã‚¿ãƒã‚¿ã®æ™‚æœŸã‚‚å®‰å¿ƒã€‚
âœ“ å‡ºç”£å‰ã«ã”äºˆç´„ã§æ—¥ç¨‹ç¢ºä¿
âœ“ ç”£å¾Œã«æ—¥ç¨‹èª¿æ•´OK
âœ“ è¨ªå•ç€ã‚‚å¯¾å¿œ`, 600);

  addStepIndicator('â€” Step 3: ãƒ—ãƒ©ãƒ³ææ¡ˆ â€”');

  await addMsg('bot', 'å¦Šå¨ ä¸­ã®ã”äºˆç´„ãŒä¸€ç•ªã‚¹ãƒ ãƒ¼ã‚ºã§ã™ã€‚', 600);

  addChoices([
    { label: 'ğŸ‘¶ ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³æ’®å½±ã‚’äºˆç´„ã—ãŸã„', value: 'nb' },
    { label: 'ğŸ¤° ãƒã‚¿ãƒ‹ãƒ†ã‚£ãƒ•ã‚©ãƒˆã‚‚æ’®ã‚ŠãŸã„', value: 'maternity' },
    { label: 'â›©ï¸ ãŠå®®å‚ã‚Šã‚‚ä¸€ç·’ã«ç›¸è«‡ã—ãŸã„', value: 'bundle' },
    { label: 'ğŸ¤” ã‚‚ã†å°‘ã—è€ƒãˆãŸã„', value: 'later' }
  ], handlePregnantChoice);
}

async function handlePregnantChoice(choice) {
  addStepIndicator('â€” Step 4: äºˆç´„ãƒ»ç›¸è«‡ â€”');

  if (choice === 'nb') {
    currentPlanType = 'newborn'; // ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ç”¨äºˆç´„URL
    await addMsg('bot', 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³æ’®å½±ã§ã™ã­ã€‚\næ’®å½±å ´æ‰€ã¯ã©ã¡ã‚‰ãŒã”å¸Œæœ›ã§ã™ã‹ï¼Ÿ');

    await addMsg('bot', `æ’®å½±ãƒ—ãƒ©ãƒ³ã«ã‚ˆã£ã¦æ–™é‡‘ãŒç•°ãªã‚Šã¾ã™ã€‚
â‘ ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªãƒ—ãƒ©ãƒ³: Â¥30,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000
â‘¡ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å‡ºå¼µãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³: Â¥44,000ï¼ˆç¨åˆ¥ï¼‰
â‘¢ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãƒ—ãƒ©ãƒ³: Â¥49,000ï¼ˆç¨åˆ¥ï¼‰`, 600);

    addChoices([
      { label: 'ğŸ“¸ ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½±', value: 'studio_preg' },
      { label: 'ğŸ  è‡ªå®…å‡ºå¼µæ’®å½±', value: 'home_preg' }
    ], async (pregNbStyle) => {

      if (pregNbStyle === 'studio_preg') {
        // ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½±ã‚µãƒ³ãƒ—ãƒ«å†™çœŸã‚’è¡¨ç¤º
        addImageGallery([
          { src: 'assets/images/newborn/nb-1.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 1' },
          { src: 'assets/images/newborn/nb-2.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 2' },
          { src: 'assets/images/newborn/nb-3.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 3' },
          { src: 'assets/images/newborn/nb-4.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 4' },
          { src: 'assets/images/newborn/nb-5.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 5' },
          { src: 'assets/images/newborn/nb-6.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 6' },
          { src: 'assets/images/newborn/nb-7.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 7' }
        ], 'â† æ¨ªã«ã‚¹ãƒ©ã‚¤ãƒ‰ã§ãã¾ã™ â†’');

        await new Promise(r => setTimeout(r, 2500));

        addRichMsg({
          gradient: 'linear-gradient(135deg, #ff6b9d, #ff8fab)',
          title: 'ğŸ‘¶ ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªãƒ—ãƒ©ãƒ³',
          subtitle: 'Â¥30,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
          features: ['50ã‚«ãƒƒãƒˆï¼ˆãƒ¬ã‚¿ãƒƒãƒ10ï¼‹è‰²å‘³æ˜ã‚‹ã•èª¿æ•´40ï¼‰', 'èµ¤ã¡ã‚ƒã‚“ãƒ»å®¶æ—ãƒ»å…„å¼Ÿã®3ã‚·ãƒ¼ãƒ³ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ2ï¼‰', 'åœŸæ—¥ç¥ +3,000å††', 'å®Œå…¨è²¸åˆ‡', 'å‡ºç”£å¾Œã«ãŠæ—¥ã«ã¡èª¿æ•´OK', 'æ˜æœ—ä¼šè¨ˆãƒ»å¤§æ‰‹ã®åŠé¡'],
          urgency: 'ç”Ÿå¾Œ3é€±é–“ã‚’éãã‚‹ã¨æ–°ç”Ÿå…ã‚‰ã—ã„ãƒãƒ¼ã‚ºãŒé›£ã—ããªã‚Šã¾ã™',
          proof: 'èµ¤ã¡ã‚ƒã‚“ã®ãƒšãƒ¼ã‚¹ã«åˆã‚ã›ãŸæ’®å½±ã§å®‰å¿ƒ'
        });

      } else {
        await addMsg('bot', 'ã”è‡ªå®…ã§ã®å‡ºå¼µæ’®å½±ã§ã™ã­ã€‚\n\nèµ¤ã¡ã‚ƒã‚“ã®ç§»å‹•è² æ‹…ãŒãªãã€è‡ªç„¶å…‰ã‚’æ´»ã‹ã—ãŸæŸ”ã‚‰ã‹ã„é›°å›²æ°—ã§æ’®å½±ã§ãã¾ã™ã€‚');

        addChoices([
          { label: 'ğŸ‘¶ èµ¤ã¡ã‚ƒã‚“ã®ã¿ã§è‰¯ã„', value: 'baby_only' },
          { label: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶æ—ã€å…„å¼Ÿã‚‚ä¸€ç·’ã«', value: 'with_family' }
        ], async (homeChoice) => {

          if (homeChoice === 'baby_only') {
            await addMsg('bot', 'èµ¤ã¡ã‚ƒã‚“ã®ã¿ã®ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³ã§ã™ã­ã€‚');

            // å‡ºå¼µãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³æ’®å½±ã‚µãƒ³ãƒ—ãƒ«å†™çœŸã‚’è¡¨ç¤º
            addImageGallery([
              { src: 'assets/images/newborn-home/nb-home-1.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å‡ºå¼µæ’®å½± 1' },
              { src: 'assets/images/newborn-home/nb-home-2.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å‡ºå¼µæ’®å½± 2' },
              { src: 'assets/images/newborn-home/nb-home-3.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å‡ºå¼µæ’®å½± 3' },
              { src: 'assets/images/newborn-home/nb-home-4.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å‡ºå¼µæ’®å½± 4' },
              { src: 'assets/images/newborn-home/nb-home-5.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å‡ºå¼µæ’®å½± 5' }
            ], 'â† æ¨ªã«ã‚¹ãƒ©ã‚¤ãƒ‰ã§ãã¾ã™ â†’');

            await new Promise(r => setTimeout(r, 2500));

            addRichMsg({
              gradient: 'linear-gradient(135deg, #81c784, #a5d6a7)',
              title: 'ğŸ’ ãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³(å‡ºå¼µ)',
              subtitle: 'Â¥44,000ï¼ˆç¨åˆ¥ï¼‰',
              features: ['ã”è‡ªå®…ã§æ’®å½±ï¼ˆèµ¤ã¡ã‚ƒã‚“ã€ãƒãƒã®ç§»å‹•ãªã—ï¼‰', 'å‡ºç”£å¾Œã«ãŠæ—¥ã«ã¡èª¿æ•´OK', '20ã‚«ãƒƒãƒˆï¼ˆãƒ¬ã‚¿ãƒƒãƒ10ï¼‹è‰²å‘³æ˜ã‚‹ã•èª¿æ•´10ï¼‰', '2ã‚·ãƒ¼ãƒ³ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ1ï¼‰ãƒ»ç€æ›¿ãˆ2ç€'],
              urgency: 'ç”Ÿå¾Œ2ã€œ3é€±é–“ãŒãƒ™ã‚¹ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°',
              proof: 'ã„ã¤ã‚‚ã®å ´æ‰€ã ã‹ã‚‰èµ¤ã¡ã‚ƒã‚“ã‚‚ãƒªãƒ©ãƒƒã‚¯ã‚¹'
            });

          } else {
            await addMsg('bot', 'å®¶æ—ã€å…„å¼Ÿã‚‚ä¸€ç·’ã«æ®‹ã—ãŸã„æ–¹ã¯ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãƒ—ãƒ©ãƒ³ã§ã™ã­ã€‚');

            // å®¶æ—æ’®å½±ã‚µãƒ³ãƒ—ãƒ«å†™çœŸã‚’è¡¨ç¤º
            addImageGallery([
              { src: 'assets/images/newborn-home/nb-basic-1.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å®¶æ—æ’®å½± 1' },
              { src: 'assets/images/newborn-home/nb-basic-2.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å®¶æ—æ’®å½± 2' },
              { src: 'assets/images/newborn-home/nb-basic-3.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å®¶æ—æ’®å½± 3' },
              { src: 'assets/images/newborn-home/nb-basic-4.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å®¶æ—æ’®å½± 4' },
              { src: 'assets/images/newborn-home/nb-basic-5.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å®¶æ—æ’®å½± 5' }
            ], 'â† æ¨ªã«ã‚¹ãƒ©ã‚¤ãƒ‰ã§ãã¾ã™ â†’');

            await new Promise(r => setTimeout(r, 2500));

            addRichMsg({
              gradient: 'linear-gradient(135deg, #ff6b9d, #ff8fab)',
              title: 'ğŸ‘¶ ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãƒ—ãƒ©ãƒ³(å‡ºå¼µ)',
              subtitle: 'Â¥49,000ï¼ˆç¨åˆ¥ï¼‰',
              features: ['ã”è‡ªå®…ã§æ’®å½±ï¼ˆèµ¤ã¡ã‚ƒã‚“ã€ãƒãƒã®ç§»å‹•ãªã—ï¼‰', 'å‡ºç”£å¾Œã«ãŠæ—¥ã«ã¡èª¿æ•´OK', '40ã‚«ãƒƒãƒˆï¼ˆãƒ¬ã‚¿ãƒƒãƒ15ï¼‹è‰²å‘³æ˜ã‚‹ã•èª¿æ•´25ï¼‰', '3ã‚·ãƒ¼ãƒ³ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ2ï¼‰ãƒ»ç€æ›¿ãˆ3ç€ãƒ»å®¶æ—OK'],
              urgency: 'ç”Ÿå¾Œ2ã€œ3é€±é–“ãŒãƒ™ã‚¹ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°',
              proof: 'å®¶æ—ã¿ã‚“ãªã§æ€ã„å‡ºã‚’æ®‹ã›ã¾ã™'
            });
          }
        });
      }
    });
  } else if (choice === 'maternity') {
    currentPlanType = 'other'; // ãƒã‚¿ãƒ‹ãƒ†ã‚£ç”¨äºˆç´„URL
    // ãƒã‚¿ãƒ‹ãƒ†ã‚£å†™çœŸã‚’è¡¨ç¤º
    addImageMsg('https://hikarinostudio.com/wp-content/uploads/2025/08/158.png', 'ãƒã‚¿ãƒ‹ãƒ†ã‚£ãƒ•ã‚©ãƒˆãƒ¡ã‚¤ãƒ³');
    await new Promise(r => setTimeout(r, 800));
    addImageMsg('https://hikarinostudio.com/wp-content/uploads/2025/08/157-563x750.png', 'ãƒã‚¿ãƒ‹ãƒ†ã‚£ãƒ•ã‚©ãƒˆã‚®ãƒ£ãƒ©ãƒªãƒ¼');
    await new Promise(r => setTimeout(r, 800));

    addRichMsg({
      gradient: 'linear-gradient(135deg, #c06bc7, #e8a0e8)',
      title: 'ğŸ¤° ãƒã‚¿ãƒ‹ãƒ†ã‚£ãƒ•ã‚©ãƒˆ',
      subtitle: 'Â¥30,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
      features: ['60ã‚«ãƒƒãƒˆæ’®å½±', 'å¤«å©¦æ’®å½±ã‚µãƒ¼ãƒ“ã‚¹', 'ç§æœ+ãŠç€æ›¿ãˆ1ç€', 'å¹³æ—¥ãƒ»åœŸæ›œã®ã¿'],
      proof: 'ä¸€ç”Ÿã«ä¸€åº¦ã®ãƒã‚¿ãƒ‹ãƒ†ã‚£æœŸã‚’å½¢ã«æ®‹ã›ã¾ã™'
    });
  } else if (choice === 'bundle') {
    currentPlanType = 'other'; // ãƒãƒ³ãƒ‰ãƒ«ç”¨äºˆç´„URL
    await addMsg('bot', 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ï¼‹ãŠå®®å‚ã‚Šã®ã‚»ãƒƒãƒˆæ’®å½±ã€ç´ æ™´ã‚‰ã—ã„é¸æŠã§ã™ï¼');
    addBundleMsg({
      title: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ï¼‹ãŠå®®å‚ã‚Š',
      tag: 'ç¶šã‘ã¦æ’®å½±ã•ã‚Œã‚‹ãƒãƒã«äººæ°—',
      items: [
        { name: 'ğŸ‘¶ ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ãƒ•ã‚©ãƒˆï¼ˆ50ã‚«ãƒƒãƒˆï¼‰', originalPrice: 'Â¥38,500' },
        { name: 'â›©ï¸ ãŠå®®å‚ã‚Šæ’®å½±ï¼ˆ60ã‚«ãƒƒãƒˆï¼‰', originalPrice: 'Â¥33,000' },
        { name: 'ğŸ‘˜ è¨ªå•ç€ãƒ¬ãƒ³ã‚¿ãƒ«ï¼‹ç€ä»˜ã‘ï¼ˆãƒ™ãƒ¼ã‚·ãƒƒã‚¯ï¼‰', originalPrice: 'ç„¡æ–™' }
      ],
      totalPrice: '65,000'
    });
    await new Promise(r => setTimeout(r, 500));
    await addMsg('bot', 'ãŠå®®å‚ã‚Šã§ã¯è¨ªå•ç€ã®ç€ä»˜ã‘ã‚‚ç„¡æ–™ã§å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚\nç¥ç¤¾ãƒ­ã‚±ãªã‚‰æ’®å½±å½“æ—¥ã«ãã®ã¾ã¾ãŠå‚ã‚Šã§ãã¾ã™ã€‚', 600);
  } else {
    await addMsg('bot', 'ã‚‚ã¡ã‚ã‚“ã§ã™ï¼ã‚†ã£ãã‚Šã”æ¤œè¨ãã ã•ã„ğŸ˜Š');
    addChoices([
      { label: 'ğŸ“¸ æ’®å½±ã‚µãƒ³ãƒ—ãƒ«ã‚’è¦‹ãŸã„', value: 'see_samples' },
      { label: 'ğŸ  ã‚¹ã‚¿ã‚¸ã‚ªã®é›°å›²æ°—ã‚’è¦‹ãŸã„', value: 'see_studio' },
      { label: 'ğŸ’° æ–™é‡‘ã‚’è©³ã—ãçŸ¥ã‚ŠãŸã„', value: 'see_price' },
      { label: 'ğŸ’¬ ãã®ä»–ã®è³ªå•', value: 'question' }
    ], async (laterChoice) => {
      if (laterChoice === 'see_samples') {
        await addMsg('bot', 'æ’®å½±å®Ÿç¸¾ã¯Instagramã§æ¯æ—¥æ›´æ–°ä¸­ï¼');
        addInstagramCard(
          '@hikarino_studio',
          'hikarino studioï¼ˆãƒ¡ã‚¤ãƒ³ï¼‰',
          'assets/images/instagram-qr-main.jpg',
          'https://www.instagram.com/hikarino_studio/'
        );
      } else if (laterChoice === 'see_studio') {
        await addMsg('bot', 'ã‚¹ã‚¿ã‚¸ã‚ªã®é›°å›²æ°—ã¯Instagramã§ãƒã‚§ãƒƒã‚¯ï¼\nç´ æ•µãªæ’®å½±ãŒãŸãã•ã‚“è¦‹ã‚‰ã‚Œã¾ã™ã‚ˆâœ¨');
        addInstagramCard(
          '@hikarinostudio_shimokitakata',
          'hikarino studioä¸‹åŒ—æ–¹',
          'assets/images/instagram-qr-shimokitakata.jpg',
          'https://www.instagram.com/hikarinostudio_shimokitakata/'
        );
      } else if (laterChoice === 'see_price') {
        await addMsg('bot', `ğŸ’¡ ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³æ’®å½±ã®æ–™é‡‘ã«ã¤ã„ã¦
ã€ã‚¹ã‚¿ã‚¸ã‚ªãƒ—ãƒ©ãƒ³ã€‘Â¥35,000ï¼ˆç¨åˆ¥ï¼‰
- ã‚³ã‚¹ãƒ‘æŠœç¾¤ã€è¡£è£…ãƒ»å°ç‰©ç„¡æ–™
- è¤‡æ•°ã®ã‚¹ã‚¿ã‚¸ã‚ªã§ç•°ãªã‚‹é›°å›²æ°—
ã€ãƒŠãƒãƒ¥ãƒ©ãƒ«å‡ºå¼µãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³ã€‘Â¥30,000ï¼ˆç¨åˆ¥ï¼‰
- ã”è‡ªå®…ã§æ’®å½±ã€èµ¤ã¡ã‚ƒã‚“ã®ç§»å‹•ãªã—
- è‡ªç„¶å…‰ã‚’æ´»ã‹ã—ãŸæŸ”ã‚‰ã‹ã„é›°å›²æ°—
ã€å‡ºå¼µãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãƒ—ãƒ©ãƒ³ã€‘Â¥49,000ï¼ˆç¨åˆ¥ï¼‰
- å……å®Ÿã—ãŸæ’®å½±å†…å®¹

ãŠå®®å‚ã‚Šæ’®å½±ã®è©³ç´°ã¯ã“ã¡ã‚‰ğŸ‘‡`, 800);
        addImageMsg('https://hikarinostudio.com/wp-content/uploads/2024/01/omiyamairi-banner.jpg', 'ãŠå®®å‚ã‚Šãƒ—ãƒ©ãƒ³');
        await addMsg('bot', 'https://hikarinostudio.com/omiyamairi/');
      } else if (laterChoice === 'question') {
        await addMsg('bot', 'ã©ã‚“ãªã“ã¨ã§ã‚‚ãŠæ°—è»½ã«ã©ã†ãï¼\nã‚¹ã‚¿ãƒƒãƒ•ãŒä¸å¯§ã«ãŠç­”ãˆã—ã¾ã™ã€‚');
      } else {
        await addMsg('bot', 'ã‚µãƒ³ãƒ—ãƒ«å†™çœŸã¯ã‚¹ã‚¿ã‚¸ã‚ªã®Instagramã‚„ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã‚’ãƒã‚§ãƒƒã‚¯ï¼\nç´ æ•µãªæ’®å½±ãŒè¦‹ã‚‰ã‚Œã¾ã™ã‚ˆğŸ“¸');
      }
      await addMsg('bot', 'ã”ä¸æ˜ãªç‚¹ã‚„ã”è³ªå•ã¯ãŠæ°—è»½ã«ãŠå¯„ã›ãã ã•ã„ã€‚');
    });
  }
}

// --- ç”Ÿå¾Œ1ãƒ¶æœˆä»¥å†…ãƒ•ãƒ­ãƒ¼ ---
async function flowNewborn() {
  currentPlanType = 'newborn'; // ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ç”¨äºˆç´„URL
  addStepIndicator('â€” Step 2: æ–°ç”Ÿå…ãƒãƒã¸ â€”');

  await addMsg('bot', 'ã”å‡ºç”£ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼\n\nä»Šã ã‹ã‚‰ã“ãæ’®ã‚Œã‚‹å†™çœŸãŒã‚ã‚Šã¾ã™ã€‚');
  await addMsg('bot', 'èµ¤ã¡ã‚ƒã‚“ã®æˆé•·ã¯æœ¬å½“ã«æ—©ã„ã§ã™ã‚ˆã­ã€‚\næ–°ç”Ÿå…ã®ã“ã®è¡¨æƒ…ã€ã“ã®ã‚µã‚¤ã‚ºæ„Ÿã¯ä»Šã ã‘ã®ã‚‚ã®ã€‚', 800);

  addChoices([
    { label: 'ğŸ‘¶ ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³æ’®å½±ãŒã—ãŸã„', value: 'nb' },
    { label: 'â›©ï¸ ãŠå®®å‚ã‚Šã®æ’®å½±ãŒã—ãŸã„', value: 'omiya' },
    { label: 'ğŸ€ ä¸¡æ–¹ã¾ã¨ã‚ã¦ç›¸è«‡ã—ãŸã„', value: 'both' }
  ], handleNewbornChoice);
}

async function handleNewbornChoice(choice) {
  addStepIndicator('â€” Step 3: ãƒ—ãƒ©ãƒ³ææ¡ˆ â€”');

  if (choice === 'nb') {
    currentPlanType = 'newborn'; // ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ç”¨äºˆç´„URL
    await addMsg('bot', 'èµ¤ã¡ã‚ƒã‚“ã®ãƒšãƒ¼ã‚¹ã«åˆã‚ã›ã¦æ’®å½±ã™ã‚‹ã®ã§ã€ã‚†ã£ãŸã‚Šéã”ã—ã¦ã„ãŸã ã‘ã¾ã™ã€‚\n\næ’®å½±å ´æ‰€ã¯ã©ã¡ã‚‰ãŒã”å¸Œæœ›ã§ã™ã‹ï¼Ÿ');

    await addMsg('bot', `èµ¤ã¡ã‚ƒã‚“ã®ç§»å‹•è² æ‹…ã‚’è€ƒæ…®ã—ã¦
ã”è‡ªå®…ã«è¿‘ã„ã‚¹ã‚¿ã‚¸ã‚ªãŒãŠã™ã™ã‚ã§ã™ğŸ 
ğŸ“ å®®å´å¸‚ã«ãŠä½ã¾ã„ãªã‚‰ â†’ ä¸‹åŒ—æ–¹ã‚¹ã‚¿ã‚¸ã‚ª
ğŸ“ éƒ½åŸå¸‚ã«ãŠä½ã¾ã„ãªã‚‰ â†’ éƒ½åŸã‚¹ã‚¿ã‚¸ã‚ª
ğŸ“ ã©ã¡ã‚‰ã‚‚é ã„å ´åˆã¯ â†’ å‡ºå¼µæ’®å½±ãŒãŠã™ã™ã‚`, 600);

    addStudioComparison();
    await new Promise(r => setTimeout(r, 1200));

    await addMsg('bot', `æ’®å½±ãƒ—ãƒ©ãƒ³ã«ã‚ˆã£ã¦æ–™é‡‘ãŒç•°ãªã‚Šã¾ã™ã€‚
â‘ ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªãƒ—ãƒ©ãƒ³: Â¥30,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000
â‘¡ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å‡ºå¼µãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³: Â¥44,000ï¼ˆç¨åˆ¥ï¼‰
â‘¢ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãƒ—ãƒ©ãƒ³: Â¥49,000ï¼ˆç¨åˆ¥ï¼‰`, 600);

    addChoices([
      { label: 'ğŸ“¸ ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½±', value: 'studio_nb' },
      { label: 'ğŸ  è‡ªå®…å‡ºå¼µæ’®å½±', value: 'home_nb' }
    ], async (nbStyle) => {

      addStepIndicator('â€” Step 4: ãƒ—ãƒ©ãƒ³è©³ç´° â€”');

      if (nbStyle === 'studio_nb') {
        // ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½±ã‚µãƒ³ãƒ—ãƒ«å†™çœŸã‚’è¡¨ç¤º
        addImageGallery([
          { src: 'assets/images/newborn/nb-1.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 1' },
          { src: 'assets/images/newborn/nb-2.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 2' },
          { src: 'assets/images/newborn/nb-3.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 3' },
          { src: 'assets/images/newborn/nb-4.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 4' },
          { src: 'assets/images/newborn/nb-5.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 5' },
          { src: 'assets/images/newborn/nb-6.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 6' },
          { src: 'assets/images/newborn/nb-7.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 7' }
        ], 'â† æ¨ªã«ã‚¹ãƒ©ã‚¤ãƒ‰ã§ãã¾ã™ â†’');

        await new Promise(r => setTimeout(r, 2500));

        await addMsg('bot', 'ã‚¹ã‚¿ã‚¸ã‚ªãƒ—ãƒ©ãƒ³ã¯è¡£è£…ãƒ»å°ç‰©ãŒã™ã¹ã¦ç„¡æ–™ã€‚\nå®Œå…¨è²¸åˆ‡ãªã®ã§æˆä¹³ã‚‚ãŠã‚€ã¤æ›¿ãˆã‚‚æ°—å…¼ã­ãªãã§ãã¾ã™ã€‚');

        addRichMsg({
          gradient: 'linear-gradient(135deg, #ff6b9d, #ff8fab)',
          title: 'ğŸ‘¶ ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªãƒ—ãƒ©ãƒ³',
          subtitle: 'Â¥30,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
          features: ['50ã‚«ãƒƒãƒˆï¼ˆãƒ¬ã‚¿ãƒƒãƒ10ï¼‹è‰²å‘³æ˜ã‚‹ã•èª¿æ•´40ï¼‰', 'èµ¤ã¡ã‚ƒã‚“ãƒ»å®¶æ—ãƒ»å…„å¼Ÿã®3ã‚·ãƒ¼ãƒ³ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ2ï¼‰', 'åœŸæ—¥ç¥ +3,000å††', 'å®Œå…¨è²¸åˆ‡', 'å‡ºç”£å¾Œã«ãŠæ—¥ã«ã¡èª¿æ•´OK', 'æ˜æœ—ä¼šè¨ˆãƒ»å¤§æ‰‹ã®åŠé¡'],
          urgency: 'ç”Ÿå¾Œ3é€±é–“ã‚’éãã‚‹ã¨æ–°ç”Ÿå…ã‚‰ã—ã„ãƒãƒ¼ã‚ºãŒé›£ã—ããªã‚Šã¾ã™',
          proof: 'èµ¤ã¡ã‚ƒã‚“ã®ãƒšãƒ¼ã‚¹ã«åˆã‚ã›ãŸæ’®å½±ã§å®‰å¿ƒ'
        });

        await sendNewbornStudioInfo();

      } else {
        await addMsg('bot', 'ã”è‡ªå®…ã§ã®å‡ºå¼µæ’®å½±ã§ã™ã­ã€‚\n\nèµ¤ã¡ã‚ƒã‚“ã®ç§»å‹•è² æ‹…ãŒãªãã€è‡ªç„¶å…‰ã‚’æ´»ã‹ã—ãŸæŸ”ã‚‰ã‹ã„é›°å›²æ°—ã§æ’®å½±ã§ãã¾ã™ã€‚');

        addChoices([
          { label: 'ğŸ‘¶ èµ¤ã¡ã‚ƒã‚“ã®ã¿ã§è‰¯ã„', value: 'baby_only' },
          { label: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶æ—ã€å…„å¼Ÿã‚‚ä¸€ç·’ã«', value: 'with_family' }
        ], async (homeChoice) => {

          if (homeChoice === 'baby_only') {
            await addMsg('bot', 'èµ¤ã¡ã‚ƒã‚“ã®ã¿ã®ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³ã§ã™ã­ã€‚');

            // å‡ºå¼µãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³æ’®å½±ã‚µãƒ³ãƒ—ãƒ«å†™çœŸã‚’è¡¨ç¤º
            addImageGallery([
              { src: 'assets/images/newborn-home/nb-home-1.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å‡ºå¼µæ’®å½± 1' },
              { src: 'assets/images/newborn-home/nb-home-2.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å‡ºå¼µæ’®å½± 2' },
              { src: 'assets/images/newborn-home/nb-home-3.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å‡ºå¼µæ’®å½± 3' },
              { src: 'assets/images/newborn-home/nb-home-4.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å‡ºå¼µæ’®å½± 4' },
              { src: 'assets/images/newborn-home/nb-home-5.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å‡ºå¼µæ’®å½± 5' }
            ], 'â† æ¨ªã«ã‚¹ãƒ©ã‚¤ãƒ‰ã§ãã¾ã™ â†’');

            await new Promise(r => setTimeout(r, 2500));

            addRichMsg({
              gradient: 'linear-gradient(135deg, #81c784, #a5d6a7)',
              title: 'ğŸ’ ãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³(å‡ºå¼µ)',
              subtitle: 'Â¥44,000ï¼ˆç¨åˆ¥ï¼‰',
              features: ['ã”è‡ªå®…ã§æ’®å½±ï¼ˆèµ¤ã¡ã‚ƒã‚“ã€ãƒãƒã®ç§»å‹•ãªã—ï¼‰', 'å‡ºç”£å¾Œã«ãŠæ—¥ã«ã¡èª¿æ•´OK', '20ã‚«ãƒƒãƒˆï¼ˆãƒ¬ã‚¿ãƒƒãƒ10ï¼‹è‰²å‘³æ˜ã‚‹ã•èª¿æ•´10ï¼‰', '2ã‚·ãƒ¼ãƒ³ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ1ï¼‰ãƒ»ç€æ›¿ãˆ2ç€'],
              urgency: 'ç”Ÿå¾Œ2ã€œ3é€±é–“ãŒãƒ™ã‚¹ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°',
              proof: 'ã„ã¤ã‚‚ã®å ´æ‰€ã ã‹ã‚‰èµ¤ã¡ã‚ƒã‚“ã‚‚ãƒªãƒ©ãƒƒã‚¯ã‚¹'
            });

          } else {
            await addMsg('bot', 'å®¶æ—ã€å…„å¼Ÿã‚‚ä¸€ç·’ã«æ®‹ã—ãŸã„æ–¹ã¯ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãƒ—ãƒ©ãƒ³ã§ã™ã­ã€‚');

            // å®¶æ—æ’®å½±ã‚µãƒ³ãƒ—ãƒ«å†™çœŸã‚’è¡¨ç¤º
            addImageGallery([
              { src: 'assets/images/newborn-home/nb-basic-1.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å®¶æ—æ’®å½± 1' },
              { src: 'assets/images/newborn-home/nb-basic-2.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å®¶æ—æ’®å½± 2' },
              { src: 'assets/images/newborn-home/nb-basic-3.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å®¶æ—æ’®å½± 3' },
              { src: 'assets/images/newborn-home/nb-basic-4.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å®¶æ—æ’®å½± 4' },
              { src: 'assets/images/newborn-home/nb-basic-5.jpg', alt: 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³å®¶æ—æ’®å½± 5' }
            ], 'â† æ¨ªã«ã‚¹ãƒ©ã‚¤ãƒ‰ã§ãã¾ã™ â†’');

            await new Promise(r => setTimeout(r, 2500));

            addRichMsg({
              gradient: 'linear-gradient(135deg, #ff6b9d, #ff8fab)',
              title: 'ğŸ‘¶ ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãƒ—ãƒ©ãƒ³(å‡ºå¼µ)',
              subtitle: 'Â¥49,000ï¼ˆç¨åˆ¥ï¼‰',
              features: ['ã”è‡ªå®…ã§æ’®å½±ï¼ˆèµ¤ã¡ã‚ƒã‚“ã€ãƒãƒã®ç§»å‹•ãªã—ï¼‰', 'å‡ºç”£å¾Œã«ãŠæ—¥ã«ã¡èª¿æ•´OK', '40ã‚«ãƒƒãƒˆï¼ˆãƒ¬ã‚¿ãƒƒãƒ15ï¼‹è‰²å‘³æ˜ã‚‹ã•èª¿æ•´25ï¼‰', '3ã‚·ãƒ¼ãƒ³ï¼ˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ2ï¼‰ãƒ»ç€æ›¿ãˆ3ç€ãƒ»å®¶æ—OK'],
              urgency: 'ç”Ÿå¾Œ2ã€œ3é€±é–“ãŒãƒ™ã‚¹ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°',
              proof: 'å®¶æ—ã¿ã‚“ãªã§æ€ã„å‡ºã‚’æ®‹ã›ã¾ã™'
            });
          }
        });
      }
    });
  } else if (choice === 'omiya') {
    currentPlanType = 'other'; // ãŠå®®å‚ã‚Šç”¨äºˆç´„URL
    await addMsg('bot', 'ãŠå®®å‚ã‚Šãƒ—ãƒ©ãƒ³ã¯æ’®å½±ã‚¹ã‚¿ã‚¤ãƒ«ãŒé¸ã¹ã¾ã™ã€‚\nã¾ãšã€æ’®å½±å ´æ‰€ã‚’ãŠèã‹ã›ãã ã•ã„ã€‚');

    addImageGallery([
      { src: 'assets/images/omiyamairi-intro/omiya-intro-1.jpg', alt: 'ãŠå®®å‚ã‚Šæ’®å½± ç¥ç¤¾ãƒ­ã‚±' },
      { src: 'assets/images/omiyamairi-intro/omiya-intro-2.jpg', alt: 'ãŠå®®å‚ã‚Šæ’®å½± ã‚¹ã‚¿ã‚¸ã‚ªï¼†ãƒ­ã‚±' },
      { src: 'assets/images/omiyamairi-intro/omiya-intro-3.jpg', alt: 'ãŠå®®å‚ã‚Šæ’®å½± ãŠé£Ÿã„åˆã‚' },
      { src: 'assets/images/omiyamairi-intro/omiya-intro-4.jpg', alt: 'ãŠå®®å‚ã‚Šæ’®å½± èµ¤ã¡ã‚ƒã‚“' },
      { src: 'assets/images/omiyamairi-intro/omiya-intro-5.jpg', alt: 'ãŠå®®å‚ã‚Šæ’®å½± å®¶æ—' },
      { src: 'assets/images/omiyamairi-intro/omiya-intro-6.jpg', alt: 'ãŠå®®å‚ã‚Šæ’®å½± å¤«å©¦ï¼†èµ¤ã¡ã‚ƒã‚“' },
      { src: 'assets/images/omiyamairi-intro/omiya-intro-7.jpg', alt: 'ãŠå®®å‚ã‚Šæ’®å½± ãƒãƒã¨èµ¤ã¡ã‚ƒã‚“' },
      { src: 'assets/images/omiyamairi-intro/omiya-intro-8.jpg', alt: 'ãŠå®®å‚ã‚Šæ’®å½± ã‚¹ã‚¿ã‚¸ã‚ªæ¡œ' }
    ], 'â† æ¨ªã«ã‚¹ãƒ©ã‚¤ãƒ‰ã§ãã¾ã™ â†’');

    await new Promise(r => setTimeout(r, 2500));

    addChoices([
      { label: 'ğŸ“¸ ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½±ã®ã¿', value: 'studio' },
      { label: 'â›©ï¸ ã‚¹ã‚¿ã‚¸ã‚ªï¼‹ç¥ç¤¾ãƒ­ã‚±', value: 'location' }
    ], async (styleChoice) => {

      if (styleChoice === 'studio') {
        // ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½±ã‚µãƒ³ãƒ—ãƒ«å†™çœŸã‚’è¡¨ç¤º
        addImageGallery([
          { src: 'assets/images/omiyamairi/omiya-1.jpg', alt: 'ãŠå®®å‚ã‚Šã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 1' },
          { src: 'assets/images/omiyamairi/omiya-2.jpg', alt: 'ãŠå®®å‚ã‚Šã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 2' },
          { src: 'assets/images/omiyamairi/omiya-3.jpg', alt: 'ãŠå®®å‚ã‚Šã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 3' },
          { src: 'assets/images/omiyamairi/omiya-4.jpg', alt: 'ãŠå®®å‚ã‚Šã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 4' },
          { src: 'assets/images/omiyamairi/omiya-5.jpg', alt: 'ãŠå®®å‚ã‚Šã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 5' },
          { src: 'assets/images/omiyamairi/omiya-6.jpg', alt: 'ãŠå®®å‚ã‚Šã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 6' },
          { src: 'assets/images/omiyamairi/omiya-7.jpg', alt: 'ãŠå®®å‚ã‚Šã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 7' },
          { src: 'assets/images/omiyamairi/omiya-8.jpg', alt: 'ãŠå®®å‚ã‚Šã‚¹ã‚¿ã‚¸ã‚ªæ’®å½± 8' }
        ], 'â† æ¨ªã«ã‚¹ãƒ©ã‚¤ãƒ‰ã§ãã¾ã™ â†’');

        await new Promise(r => setTimeout(r, 2500));

        // ã‚¹ã‚¿ã‚¸ã‚ªã®ã¿ â†’ è¨ªå•ç€ç„¡æ–™è¨´æ±‚
        await addMsg('bot', 'ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½±ãªã‚‰ã€ãƒãƒã®è¨ªå•ç€ãƒ¬ãƒ³ã‚¿ãƒ«ï¼‹ç€ä»˜ã‘ãŒç„¡æ–™ã§ã™ï¼\n\nç”£ç€ãƒ»è¨ªå•ç€ãƒ»ç€ä»˜ã‘ãŒå…¨ã¦è¾¼ã¿ã§Â¥30,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000ã€‚');

        addStepIndicator('â€” Step 4: ãŠå®®å‚ã‚Šãƒ™ãƒ¼ã‚·ãƒƒã‚¯ â€”');

        addRichMsg({
          gradient: 'linear-gradient(135deg, #4a90d9, #7ab8e8)',
          title: 'â›©ï¸ ãŠå®®å‚ã‚Šãƒ™ãƒ¼ã‚·ãƒƒã‚¯',
          subtitle: 'Â¥30,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
          features: ['æ˜æœ—ä¼šè¨ˆãƒ»å¤§æ‰‹ã®åŠé¡', '60ã‚«ãƒƒãƒˆï¼ˆæ˜ã‚‹ã•ãƒ»è‰²å‘³èª¿æ•´æ¸ˆã¿ï¼‰', 'è¨ªå•ç€ãƒ¬ãƒ³ã‚¿ãƒ«ãƒ»ç€ä»˜ã‘ãƒ»æ’®å½±å¾Œãƒ¬ãƒ³ã‚¿ãƒ«è¾¼', 'ç”£ç€ãƒ¬ãƒ³ã‚¿ãƒ«ç„¡æ–™', 'å®®å´ç¥å®®ãƒ­ã‚±20åˆ†ï¼ˆ1æ—¥ã§å®Œçµï¼‰', 'åœŸæ—¥ç¥ +3,000å††'],
          proof: 'ç”£ç€ãƒ»è¨ªå•ç€ã®ç€ã›æ–¹ã‚‚ãŠä»»ã›ãã ã•ã„'
        });


      } else {
        // ç¥ç¤¾ãƒ­ã‚± â†’ ç¥ç¤¾é¸æŠ
        await addMsg('bot', 'ç¥ç¤¾ãƒ­ã‚±ã‚’ã”å¸Œæœ›ã§ã™ã­ï¼\n\nã‚¹ã‚¿ã‚¸ã‚ªã‹ã‚‰ç¥ç¤¾ã¾ã§è»Šã§5åˆ†ã€‚\næ’®å½±â†’ãŠå‚ã‚ŠãŒ1æ—¥ã§å®Œçµã—ã¾ã™ã€‚');
        await addMsg('bot', 'â° æ‰€è¦æ™‚é–“ã«ã¤ã„ã¦\nç€æ›¿ãˆã€œæ’®å½±çµ‚äº†ã¾ã§ç´„1ã€œ1.5æ™‚é–“ã§ã™ã€‚\nãŠå­æ§˜ã®ä½“èª¿ã‚„ã”æ©Ÿå«Œã«ã‚ˆã‚Šå‰å¾Œã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚');

        addChoices([
          { label: 'ğŸ“ å®®å´ç¥å®®ï¼ˆä¸‹åŒ—æ–¹ã‚¹ã‚¿ã‚¸ã‚ªï¼‰', value: 'shimokitakata' },
          { label: 'ğŸ“ ç¥æŸ±å®®ï¼ˆéƒ½åŸã‚¹ã‚¿ã‚¸ã‚ªï¼‰', value: 'miyakonojo' }
        ], async (shrineChoice) => {

          addStepIndicator('â€” Step 4: å½“æ—¥ã®æµã‚Œ â€”');

          const shrineInfo = {
            shimokitakata: {
              shrine: 'å®®å´ç¥å®®',
              feature: 'æœ¨æ¼ã‚Œæ—¥ã¨å‚é“ã®é›°å›²æ°—ãŒç´ æ•µ',
              studio: 'ä¸‹åŒ—æ–¹ã‚¹ã‚¿ã‚¸ã‚ª'
            },
            miyakonojo: {
              shrine: 'ç¥æŸ±å®®',
              feature: 'ç™½ã„é³¥å±…ã¨åºƒã„å‚é“ãŒç‰¹å¾´',
              studio: 'éƒ½åŸã‚¹ã‚¿ã‚¸ã‚ª'
            }
          };

          const info = shrineInfo[shrineChoice];

          await addMsg('bot', `${info.shrine}ï¼ˆ${info.studio}ã‹ã‚‰è»Š5åˆ†ï¼‰\n${info.feature}ã§ã™ã€‚`);

          // æ’®å½±ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä¾‹ã‚’è¡¨ç¤º
          await addMsg('bot', `æ’®å½±ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ä¾‹

9:00 ã‚¹ã‚¿ã‚¸ã‚ªåˆ°ç€
ç€ä»˜ã‘ãƒ»æ’®å½±æº–å‚™

9:30 ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½±
å®¶æ—å†™çœŸãƒ»èµ¤ã¡ã‚ƒã‚“ã®ã‚¢ãƒƒãƒ—ç­‰ï¼ˆ60åˆ†ï¼‰

10:00 ç¥ç¤¾ã¸ç§»å‹•
è»Šã§5åˆ†

10:15 ç¥ç¤¾ãƒ­ã‚±æ’®å½±
å‚é“ãƒ»å¢ƒå†…ã§æ’®å½±ï¼ˆ20åˆ†ï¼‰

10:30 ãã®ã¾ã¾ãŠå‚ã‚Š
å¾¡ç¥ˆç¥·ãƒ»è¨˜å¿µæ’®å½±
â†’ 1æ—¥ã§å…¨éƒ¨å®Œçµï¼`);


          await new Promise(r => setTimeout(r, 1000));

          await addMsg('bot', 'ãƒãƒã®è¨ªå•ç€ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚\n\nã‚¹ã‚¿ã‚¸ã‚ªï¼‹ãƒ­ã‚±ãƒ—ãƒ©ãƒ³ã®å ´åˆã€è¨ªå•ç€ã¯æ’®å½±å¾Œã‚‚ãã®ã¾ã¾ãƒ¬ãƒ³ã‚¿ãƒ«ç¶™ç¶šã§ãã¾ã™ï¼ˆ+Â¥15,000ï¼‰ã€‚', 800);

          addChoices([
            { label: 'ğŸ‘˜ è¨ªå•ç€ã‚‚å€Ÿã‚ŠãŸã„', value: 'with_kimono' },
            { label: 'ğŸ™…â€â™€ï¸ æŒå‚ã—ã¾ã™ / ä¸è¦ã§ã™', value: 'no_kimono' }
          ], async (kimonoChoice) => {

            addStepIndicator('â€” Step 5: ãƒ—ãƒ©ãƒ³ç¢ºå®š â€”');

            if (kimonoChoice === 'with_kimono') {
              await addMsg('bot', 'è¨ªå•ç€ãƒ¬ãƒ³ã‚¿ãƒ«ï¼‹ç€ä»˜ã‘ï¼‹æ’®å½±å¾Œãƒ¬ãƒ³ã‚¿ãƒ«è¾¼ã¿ã§ã€ç·é¡Â¥50,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000ã§ã™ã€‚\n\nç€ä»˜ã‘ã‚¹ã‚¿ãƒƒãƒ•ãŒå¯¾å¿œã™ã‚‹ã®ã§æº–å‚™ä¸è¦ã§ã™ã€‚');

              addRichMsg({
                gradient: 'linear-gradient(135deg, #4a90d9, #7ab8e8)',
                title: 'â›©ï¸ ãŠå®®å‚ã‚Š ã‚¹ã‚¿ã‚¸ã‚ªï¼‹ãƒ­ã‚±ï¼‹è¨ªå•ç€',
                subtitle: 'Â¥50,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
                features: ['æ˜æœ—ä¼šè¨ˆãƒ»å¤§æ‰‹ã®åŠé¡', '60ã‚«ãƒƒãƒˆï¼ˆæ˜ã‚‹ã•ãƒ»è‰²å‘³èª¿æ•´æ¸ˆã¿ï¼‰', 'è¨ªå•ç€ãƒ¬ãƒ³ã‚¿ãƒ«ãƒ»ç€ä»˜ã‘ãƒ»æ’®å½±å¾Œãƒ¬ãƒ³ã‚¿ãƒ«è¾¼', 'ç”£ç€ãƒ¬ãƒ³ã‚¿ãƒ«ç„¡æ–™', `${info.shrine}ãƒ­ã‚±20åˆ†ï¼ˆ1æ—¥ã§å®Œçµï¼‰`, 'åœŸæ—¥ç¥ +3,000å††'],
                urgency: 'ã‚¹ã‚¿ã‚¸ã‚ªâ†’ç¥ç¤¾â†’ãŠå‚ã‚ŠãŒ1æ—¥ã§å®Œçµ',
                proof: 'è¨ªå•ç€ã®ã¾ã¾å¾¡ç¥ˆç¥·ã«è¡Œã‘ã‚‹ã®ã§ã‚¹ãƒ ãƒ¼ã‚ºã§ã™'
              });

            } else {
              await addMsg('bot', 'æ‰¿çŸ¥ã—ã¾ã—ãŸã€‚\nè¨ªå•ç€ãªã—ã®å ´åˆã€ç·é¡Â¥35,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000ã§ã™ã€‚');

              addRichMsg({
                gradient: 'linear-gradient(135deg, #4a90d9, #7ab8e8)',
                title: 'â›©ï¸ ãŠå®®å‚ã‚Š ã‚¹ã‚¿ã‚¸ã‚ªï¼‹ãƒ­ã‚±',
                subtitle: 'Â¥35,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
                features: ['æ˜æœ—ä¼šè¨ˆãƒ»å¤§æ‰‹ã®åŠé¡', '60ã‚«ãƒƒãƒˆï¼ˆæ˜ã‚‹ã•ãƒ»è‰²å‘³èª¿æ•´æ¸ˆã¿ï¼‰', 'ç”£ç€ãƒ¬ãƒ³ã‚¿ãƒ«ç„¡æ–™', `${info.shrine}ãƒ­ã‚±20åˆ†ï¼ˆ1æ—¥ã§å®Œçµï¼‰`, 'åœŸæ—¥ç¥ +3,000å††'],
                urgency: 'ã‚¹ã‚¿ã‚¸ã‚ªâ†’ç¥ç¤¾â†’ãŠå‚ã‚ŠãŒ1æ—¥ã§å®Œçµ',
                proof: 'ç”£ç€ã®ç€ã›æ–¹ã‚‚ãŠä»»ã›ãã ã•ã„'
              });
            }
          });
        });
      }
    });
  } else {
    await addMsg('bot', 'ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³â†’ãŠå®®å‚ã‚Šã®æµã‚Œã§æ’®å½±ã•ã‚Œã‚‹ãƒãƒã€å¤šã„ã§ã™ï¼');
    await addMsg('bot', 'ãŠå®®å‚ã‚Šæ’®å½±è©³ç´°ã¯ã“ã¡ã‚‰ğŸ‘‡');
    addImageMsg('https://hikarinostudio.com/wp-content/uploads/2024/01/omiyamairi-banner.jpg', 'ãŠå®®å‚ã‚Šãƒ—ãƒ©ãƒ³è©³ç´°');
    await addMsg('bot', 'https://hikarinostudio.com/omiyamairi/');
  }
}

// --- åŠå¹´ã€œ2æ­³ãƒ•ãƒ­ãƒ¼ ---
async function flowToddler() {
  currentPlanType = 'other'; // ä¸€èˆ¬ç”¨äºˆç´„URL
  addStepIndicator('â€” Step 2: åŠå¹´ã€œ2æ­³ã®ãŠå­æ§˜ â€”');

  await addMsg('bot', 'åŠå¹´ã€œ2æ­³ã¯ã¨ã£ã¦ã‚‚å¯æ„›ã„æ™‚æœŸã§ã™ã­ï¼\n\næ­©ãå§‹ã‚ãŸã‚Šã€è¡¨æƒ…ãŒè±Šã‹ã«ãªã£ãŸã‚Šã€‚\nã“ã®æˆé•·ã‚’å†™çœŸã«æ®‹ã—ã¾ã›ã‚“ã‹ï¼Ÿ');

  addChoices([
    { label: 'ğŸ‚ ãƒãƒ¼ãƒ•ãƒ»ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼', value: 'birthday' },
    { label: 'ğŸ åˆç¯€å¥ï¼ˆ2ã€œ6æœˆé™å®šï¼‰', value: 'sekku' },
    { label: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ å®¶æ—æ’®å½±ã”æ¡ˆå†…', value: 'family' }
  ], async (choice) => {
    addStepIndicator('â€” Step 3: ãƒ—ãƒ©ãƒ³ææ¡ˆ â€”');
    if (choice === 'birthday') {
      await addMsg('bot', '1æ­³ã®ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼ã¯è¡£è£…ãƒã‚§ãƒ³ã‚¸ã§2ã¤ã®é›°å›²æ°—ã‚’æ¥½ã—ã‚ã¾ã™ï¼');

      // ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼å†™çœŸã‚®ãƒ£ãƒ©ãƒªãƒ¼
      addImageGallery([
        { src: 'assets/images/birthday/bd-1.jpg', alt: 'ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½± å®¶æ—å†™çœŸ' },
        { src: 'assets/images/birthday/bd-2.jpg', alt: 'ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½± ãŠè“å­' },
        { src: 'assets/images/birthday/bd-3.jpg', alt: 'ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½± ã¬ã„ãã‚‹ã¿' },
        { src: 'assets/images/birthday/bd-4.jpg', alt: 'ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½± ãƒãƒ¼ãƒ•ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼' },
        { src: 'assets/images/birthday/bd-5.jpg', alt: 'ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½± Happy Birthday' },
        { src: 'assets/images/birthday/bd-6.jpg', alt: 'ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½± ãƒ™ãƒ¬ãƒ¼å¸½' },
        { src: 'assets/images/birthday/bd-7.jpg', alt: 'ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½± å‚˜ã¨èŠ±' },
        { src: 'assets/images/birthday/bd-8.jpg', alt: 'ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½± ã¬ã„ãã‚‹ã¿2' },
        { src: 'assets/images/birthday/bd-9.jpg', alt: 'ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½± ãƒãƒã¨èµ¤ã¡ã‚ƒã‚“' },
        { src: 'assets/images/birthday/bd-10.jpg', alt: 'ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½± ãƒãƒã¨æŠ±ã£ã“' },
        { src: 'assets/images/birthday/bd-11.jpg', alt: 'ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½± å®¶æ—ç¬‘é¡”' },
        { src: 'assets/images/birthday/bd-12.jpg', alt: 'ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½± å®¶æ—ãµã‚Œã‚ã„' }
      ], 'â† æ¨ªã«ã‚¹ãƒ©ã‚¤ãƒ‰ã§ãã¾ã™ â†’');

      await new Promise(r => setTimeout(r, 2500));

      await addMsg('bot', 'ã©ã¡ã‚‰ã®ã‚¹ã‚¿ã‚¸ã‚ªã§æ’®å½±ã•ã‚Œã¾ã™ã‹ï¼Ÿ\n\né›°å›²æ°—ãŒå…¨ãé•ã†ã®ã§ã€ãŠå¥½ã¿ã§é¸ã¹ã¾ã™âœ¨');
      addStudioComparison();
      await new Promise(r => setTimeout(r, 1000));
      await addSiblingAppeal();
      addRichMsg({
        gradient: 'linear-gradient(135deg, #ffb347, #ffcc80)',
        title: 'ğŸ‚ ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½±',
        subtitle: 'Â¥30,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
        features: ['ğŸ’° æ˜æœ—ä¼šè¨ˆãƒ»å¤§æ‰‹ã®åŠé¡', '60ã‚«ãƒƒãƒˆæ’®å½±', 'è¡£è£…2ç€', 'â­ï¸ å…„å¼Ÿè¡£è£…1ç€ç„¡æ–™', choice === 'birthday' ? 'å®Œå…¨è²¸åˆ‡ã§ãƒªãƒ©ãƒƒã‚¯ã‚¹' : 'å¯å›ã‚Šå‰ã®å¯æ„›ã„æ™‚æœŸã«'],
        proof: 'è¡£è£…ãƒã‚§ãƒ³ã‚¸ã§2ã¤ã®é›°å›²æ°—ã‚’æ¥½ã—ã‚ã¾ã™'
      });
    } else if (choice === 'sekku') {
      addStepIndicator('â€” Step 3: åˆç¯€å¥ãƒ—ãƒ©ãƒ³ â€”');
      await addMsg('bot', `åˆç¯€å¥ã®æ’®å½±ã§ã™ã­ï¼ğŸ
hikarino studioã§ã¯2ã€œ6æœˆã®æœŸé–“é™å®šã§
ãŠã—ã‚ƒã‚Œãªã€Œç™½ç²‹(HAKI)ã€ã®å°ç‰©ã‚’
ã”ç”¨æ„ã—ã¦ã„ã¾ã™âœ¨`);
      await new Promise(r => setTimeout(r, 1000));
      addImageMsg(
        'https://hikarinostudio.com/wp-content/uploads/2025/08/147-563x750.png',
        'ç™½ç²‹(HAKI)ã®ç¯€å¥å°ç‰©',
        'ç™½ç²‹(HAKI) â€” ç™½ã‚’åŸºèª¿ã¨ã—ãŸãƒ¢ãƒ€ãƒ³ãªç¯€å¥é£¾ã‚Š'
      );
      await new Promise(r => setTimeout(r, 1200));
      addImageMsg(
        'https://hikarinostudio.com/wp-content/uploads/2025/08/148-563x750.png',
        'ç™½ç²‹(HAKI)ã®ç¯€å¥æ’®å½±ã‚µãƒ³ãƒ—ãƒ«',
        'ãŠå­æ§˜ã¨ä¸€ç·’ã«ã€‚ãŠã—ã‚ƒã‚Œãªç¯€å¥å†™çœŸãŒæ®‹ã›ã¾ã™'
      );
      await new Promise(r => setTimeout(r, 1200));
      await addMsg('bot', `ğŸ ç¯€å¥æ’®å½±ã‚ªãƒ—ã‚·ãƒ§ãƒ³
ãƒ¡ã‚¤ãƒ³ã®ãŠå­æ§˜ã®ã¿: +Â¥2,200
ãƒ¡ã‚¤ãƒ³ï¼‹å…„å¼Ÿä¸€ç·’: +Â¥3,300
ãƒ¡ã‚¤ãƒ³ï¼‹å…„å¼Ÿï¼‹å®¶æ—: +Â¥4,400
ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãƒ—ãƒ©ãƒ³Â¥33,000ã«
ç¯€å¥ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã™ã‚‹å½¢ã§ã™ğŸ’¡`, 600);
      await addMsg('bot', `ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å…„å¼Ÿã®ç¯€å¥ã‚‚ä¸€ç·’ã«ã§ãã¾ã™ï¼
â­ å…„å¼Ÿã‚‚è¡£è£…ã‚’ç€ã¦ç¯€å¥æ’®å½±OK
â­ å…„å¼Ÿã®ã‚½ãƒ­ç¯€å¥ã‚«ãƒƒãƒˆã‚‚è¿½åŠ å¯èƒ½
â­ ãŠã—ã‚ƒã‚ŒãªHAKIã®å°ç‰©ã§ç‰¹åˆ¥æ„Ÿâ—`, 600);
      addRichMsg({
        gradient: 'linear-gradient(135deg, #e8eaf6, #c5cae9)',
        title: 'ğŸ åˆç¯€å¥ãƒ—ãƒ©ãƒ³',
        subtitle: 'Â¥33,000ï¼ˆç¨åˆ¥ï¼‰ï¼‹ç¯€å¥ã‚ªãƒ—ã‚·ãƒ§ãƒ³Â¥2,200ã€œ â€»åœŸæ—¥ç¥+Â¥3,000',
        features: [
          'ğŸ’° ãƒ™ãƒ¼ã‚·ãƒƒã‚¯ãƒ—ãƒ©ãƒ³Â¥33,000',
          'ğŸ¤ ã€Œç™½ç²‹(HAKI)ã€ã®ãŠã—ã‚ƒã‚Œå°ç‰©',
          'ğŸ“¸ 60ã‚«ãƒƒãƒˆæ’®å½±',
          'â­ å…„å¼Ÿè¡£è£…1ç€ç„¡æ–™',
          'ğŸ“… 2ã€œ6æœˆã®æœŸé–“é™å®š'
        ],
        urgency: 'ç™½ç²‹(HAKI)ã¯2ã€œ6æœˆé™å®šã€‚ã“ã®æ™‚æœŸã ã‘ã®ç‰¹åˆ¥ãªæ’®å½±ã§ã™',
        proof: 'SNSã§äººæ°—ã®HAKI Ã— ãƒŠãƒãƒ¥ãƒ©ãƒ«ãªç©ºé–“ã§ç‰¹åˆ¥ãª1æš'
      });
    } else if (choice === 'casual') {
      await addMsg('bot', 'ã©ã‚“ãªç†ç”±ã§ã‚‚OKï¼æˆé•·ã®è¨˜éŒ²ã¯ä½•åº¦æ’®ã£ã¦ã‚‚è‰¯ã„ã‚‚ã®ã§ã™ã€‚');
      await addMsg('bot', 'ã©ã¡ã‚‰ã®ã‚¹ã‚¿ã‚¸ã‚ªã§æ’®å½±ã•ã‚Œã¾ã™ã‹ï¼Ÿ\n\né›°å›²æ°—ãŒå…¨ãé•ã†ã®ã§ã€ãŠå¥½ã¿ã§é¸ã¹ã¾ã™âœ¨');
      addStudioComparison();
      await new Promise(r => setTimeout(r, 1000));
      await addSiblingAppeal();
      addRichMsg({
        gradient: 'linear-gradient(135deg, #81c784, #a5d6a7)',
        title: 'ğŸ“· è¨˜å¿µæ’®å½±',
        subtitle: 'Â¥30,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
        features: ['ğŸ’° æ˜æœ—ä¼šè¨ˆãƒ»å¤§æ‰‹ã®åŠé¡', '60ã‚«ãƒƒãƒˆæ’®å½±', 'è¡£è£…2ç€', 'â­ï¸ å…„å¼Ÿè¡£è£…1ç€ç„¡æ–™', 'å®Œå…¨è²¸åˆ‡ã§ãƒªãƒ©ãƒƒã‚¯ã‚¹'],
        proof: 'å®¶æ—ã¿ã‚“ã®æ€ã„å‡ºã‚’å½¢ã«'
      });
    }
  });
}

// --- 3ã€œ7æ­³ãƒ•ãƒ­ãƒ¼ ---
async function flowChild() {
  currentPlanType = 'other'; // ä¸ƒäº”ä¸‰ç”¨äºˆç´„URL
  addStepIndicator('â€” Step 2: 3ã€œ7æ­³ã®ãŠå­æ§˜ â€”');

  await addMsg('bot', 'ä¸ƒäº”ä¸‰ã®ã”æº–å‚™ã§ã—ã‚‡ã†ã‹ï¼Ÿ\n\nãŠå­æ§˜ã®ãŠç¥ã„ã€å¤§åˆ‡ãªç¯€ç›®ã§ã™ã­ã€‚');

  addChoices([
    { label: 'ğŸ‘§ 3æ­³ã®ä¸ƒäº”ä¸‰ï¼ˆå¥³ã®å­ï¼‰', value: '3f' },
    { label: 'ğŸ‘¦ 5æ­³ã®ä¸ƒäº”ä¸‰ï¼ˆç”·ã®å­ï¼‰', value: '5m' },
    { label: 'ğŸ‘§ 7æ­³ã®ä¸ƒäº”ä¸‰ï¼ˆå¥³ã®å­ï¼‰', value: '7f' },
    { label: 'ğŸ‚ ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼æ’®å½±', value: 'bd' }
  ], async (choice) => {
    if (choice === 'bd') {
      addStepIndicator('â€” Step 3: ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼ææ¡ˆ â€”');
      addRichMsg({
        gradient: 'linear-gradient(135deg, #ffb347, #ffcc80)',
        title: 'ğŸ‚ ãƒãƒ¼ã‚¹ãƒ‡ãƒ¼ãƒ•ã‚©ãƒˆ',
        subtitle: 'Â¥30,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
        features: ['ğŸ’° æ˜æœ—ä¼šè¨ˆãƒ»å¤§æ‰‹ã®åŠé¡', '60ã‚«ãƒƒãƒˆæ’®å½±', 'è¡£è£…2ç€', 'â­ï¸ å…„å¼Ÿè¡£è£…1ç€ç„¡æ–™', 'å®Œå…¨è²¸åˆ‡ã§ãƒªãƒ©ãƒƒã‚¯ã‚¹'],
        proof: 'ãŠèª•ç”Ÿæ—¥ã®ç‰¹åˆ¥ãª1æ—¥ã‚’å†™çœŸã«'
      });
      return;
    }

    addStepIndicator('â€” Step 3: ä¸ƒäº”ä¸‰ãƒ—ãƒ©ãƒ³ â€”');

    const ageLabel = { '3f': '3æ­³å¥³ã®å­', '5m': '5æ­³ç”·ã®å­', '7f': '7æ­³å¥³ã®å­' };
    await addMsg('bot', `${ageLabel[choice]}ã®ä¸ƒäº”ä¸‰ã§ã™ã­ï¼\n\nãƒ˜ã‚¢ãƒ¡ã‚¤ã‚¯ãƒ»ç€ä»˜ã‘è¾¼ã¿ãªã®ã§ã€æ‰‹ã¶ã‚‰ã§OKã§ã™ã€‚`);

    // ä¸ƒäº”ä¸‰å†™çœŸã‚’è¡¨ç¤º
    addImageMsg('https://hikarinostudio.com/wp-content/uploads/2025/08/5b0844aa5b74bf07784ac44b978dce6c.png', 'ä¸ƒäº”ä¸‰æ’®å½±ãƒ¡ã‚¤ãƒ³');
    await new Promise(r => setTimeout(r, 800));
    addImageMsg('https://hikarinostudio.com/wp-content/uploads/2025/05/753-563x750.png', 'ä¸ƒäº”ä¸‰ã‚®ãƒ£ãƒ©ãƒªãƒ¼1');
    await new Promise(r => setTimeout(r, 800));

    await addMsg('bot', 'ã©ã¡ã‚‰ã®ã‚¹ã‚¿ã‚¸ã‚ªã§æ’®å½±ã•ã‚Œã¾ã™ã‹ï¼Ÿ\n\né›°å›²æ°—ãŒå…¨ãé•ã†ã®ã§ã€ãŠå¥½ã¿ã§é¸ã¹ã¾ã™âœ¨');
    addStudioComparison();
    await new Promise(r => setTimeout(r, 1200));

    addChoices([
      { label: 'ğŸ‘˜ ç€ç‰©ï¼‹æ´‹è£…ï¼ˆ2ç€ï¼‰ãŒã„ã„', value: 'double' },
      { label: 'â›©ï¸ ç¥ç¤¾ãƒ­ã‚±ã‚‚ã—ãŸã„', value: 'loca' },
      { label: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å…„å¼Ÿã‚‚ä¸€ç·’ã«æ’®ã‚ŠãŸã„', value: 'sibling' }
    ], async (pref) => {
      addStepIndicator('â€” Step 4: äºˆç´„ãƒ»ç›¸è«‡ â€”');

      if (pref === 'double') {
        const currentMonth = new Date().getMonth() + 1;
        const seasonMsg = (currentMonth >= 9 && currentMonth <= 12)
          ? 'ğŸ å½“æ—¥æ’®å½±å¯¾å¿œä¸­ï¼'
          : 'ğŸ“¸ å‰æ’®ã‚Šã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ä¸­ï¼';
        await addMsg('bot', `ğŸ’¡ ä¸ƒäº”ä¸‰ã®æ´‹è£…ã«ã¤ã„ã¦ ${seasonMsg}

8æœˆã¾ã§ã®ã”äºˆç´„ãªã‚‰
ç€ç‰©1ç€ï¼‹æ´‹è£…1ç€ãŒå…¨ã¦è¾¼ã¿ï¼
9æœˆä»¥é™ã¯æ´‹è£…è¿½åŠ æ–™é‡‘ãŒã‹ã‹ã‚Šã¾ã™ã€‚
å‰æ’®ã‚Šãªã‚‰æ–­ç„¶ãŠå¾—ã§ã™âœ¨`, 600);
        addRichMsg({
          gradient: 'linear-gradient(135deg, #e57373, #ef9a9a)',
          title: 'ğŸ ä¸ƒäº”ä¸‰ ç€ç‰©&æ´‹è£…ãƒ—ãƒ©ãƒ³',
          subtitle: 'Â¥35,000ã€œï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
          features: ['ğŸ’° æ˜æœ—ä¼šè¨ˆãƒ»å¤§æ‰‹ã®åŠé¡', '60ã‚«ãƒƒãƒˆæ’®å½±', 'ç€ç‰©1ç€ï¼‹æ´‹è£…1ç€', 'ãƒ˜ã‚¢ãƒ¡ã‚¤ã‚¯ãƒ»ç€ä»˜ã‘è¾¼ã¿', 'â­ï¸ å…„å¼Ÿã‚‚ç€ç‰©ç€ç”¨å¯èƒ½', 'å¸¯ãƒ»é«ªé£¾ã‚Šå«ã‚€'],
          proof: 'å‰æ’®ã‚Šãªã‚‰è¡£è£…é¸ã³æ”¾é¡Œãƒ»æ··é›‘ã‚’é¿ã‘ã‚‰ã‚Œã¾ã™'
        });
      } else if (pref === 'loca') {
        await addMsg('bot', 'ç¥ç¤¾ãƒ­ã‚±ãªã‚‰æ’®å½±â†’ãã®ã¾ã¾ãŠå‚ã‚ŠãŒ1æ—¥ã§å®Œçµã—ã¾ã™ã€‚\nã©ã¡ã‚‰ã®ç¥ç¤¾ãŒã”å¸Œæœ›ã§ã™ã‹ï¼Ÿ');
        await addMsg('bot', 'â° æ‰€è¦æ™‚é–“ã«ã¤ã„ã¦\nç€æ›¿ãˆã€œæ’®å½±çµ‚äº†ã¾ã§ç´„1ã€œ1.5æ™‚é–“ã§ã™ã€‚\nãŠå­æ§˜ã®ä½“èª¿ã‚„ã”æ©Ÿå«Œã«ã‚ˆã‚Šå‰å¾Œã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚');

        addChoices([
          { label: 'ğŸ“ å®®å´ç¥å®®ï¼ˆä¸‹åŒ—æ–¹ï¼‰', value: 'shimokitakata_753' },
          { label: 'ğŸ“ ç¥æŸ±å®®ï¼ˆéƒ½åŸï¼‰', value: 'miyakonojo_753' }
        ], async (shrine753) => {

          const shrineInfo753 = {
            shimokitakata_753: {
              shrine: 'å®®å´ç¥å®®',
              feature: 'æœ¨æ¼ã‚Œæ—¥ã¨å‚é“ã®é›°å›²æ°—ãŒç´ æ•µ',
              studio: 'ä¸‹åŒ—æ–¹ã‚¹ã‚¿ã‚¸ã‚ª'
            },
            miyakonojo_753: {
              shrine: 'ç¥æŸ±å®®',
              feature: 'ç™½ã„é³¥å±…ã¨åºƒã„å‚é“ãŒç‰¹å¾´',
              studio: 'éƒ½åŸã‚¹ã‚¿ã‚¸ã‚ª'
            }
          };

          const info753 = shrineInfo753[shrine753];

          await addMsg('bot', `${info753.shrine}ï¼ˆ${info753.studio}ã‹ã‚‰è»Š5åˆ†ï¼‰\n${info753.feature}ã§ã™ã€‚`);

          // ä¸ƒäº”ä¸‰ã®å½“æ—¥ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«
          addTimeline([
            { title: '9:00 ã‚¹ã‚¿ã‚¸ã‚ªåˆ°ç€', desc: 'ãƒ˜ã‚¢ãƒ¡ã‚¤ã‚¯ãƒ»ç€ä»˜ã‘', active: true },
            { title: '10:00 ã‚¹ã‚¿ã‚¸ã‚ªæ’®å½±', desc: 'ç€ç‰©ï¼‹æ´‹è£…ã®2ç€æ’®å½±ï¼ˆ60åˆ†ï¼‰', active: true },
            { title: '11:00 ç¥ç¤¾ã¸ç§»å‹•', desc: 'ç€ç‰©ã®ã¾ã¾è»Šã§5åˆ†', active: false },
            { title: '11:10 ç¥ç¤¾ãƒ­ã‚±æ’®å½±', desc: 'å‚é“ãƒ»å¢ƒå†…ã§æ’®å½±ï¼ˆ20åˆ†ï¼‰', active: false },
            { title: '11:30 ãã®ã¾ã¾ãŠå‚ã‚Š', desc: 'å¾¡ç¥ˆç¥·ãƒ»è¨˜å¿µæ’®å½±', active: false, highlight: 'â†’ 1æ—¥ã§å…¨éƒ¨å®Œçµï¼' }
          ]);

          await new Promise(r => setTimeout(r, 1000));

          await addMsg('bot', 'ãƒãƒã®è¨ªå•ç€ã«ã¤ã„ã¦ã‚‚ã”æ¡ˆå†…ã§ãã¾ã™ã€‚\n\nä¸ƒäº”ä¸‰ã®å ´åˆã€è¨ªå•ç€ã¯+Â¥11,000ï¼ˆç€ä»˜ã‘è¾¼ï¼‰ã§ã™ã€‚', 800);

          addChoices([
            { label: 'ğŸ‘˜ è¨ªå•ç€ã‚‚å€Ÿã‚ŠãŸã„', value: 'with_kimono_753' },
            { label: 'ğŸ™…â€â™€ï¸ ä¸è¦ã§ã™', value: 'no_kimono_753' }
          ], async (kimono753) => {

            if (kimono753 === 'with_kimono_753') {
              await addMsg('bot', 'è¨ªå•ç€ï¼‹ç€ä»˜ã‘è¾¼ã¿ã§ã€ç·é¡Â¥42,000ï¼ˆç¨åˆ¥ï¼‰ã§ã™ã€‚\n\nè¦ªå­ã§ç€ç‰©å§¿ã®è¨˜å¿µå†™çœŸã€ç´ æ•µã§ã™ã­ã€‚');

              addRichMsg({
                gradient: 'linear-gradient(135deg, #4a90d9, #7ab8e8)',
                title: 'â›©ï¸ ä¸ƒäº”ä¸‰ ã‚¹ã‚¿ã‚¸ã‚ªï¼‹ãƒ­ã‚±ï¼ˆè¨ªå•ç€ä»˜ãï¼‰',
                subtitle: 'Â¥42,000ï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
                features: ['ğŸ’° æ˜æœ—ä¼šè¨ˆãƒ»å¤§æ‰‹ã®åŠé¡', '60ã‚«ãƒƒãƒˆï¼ˆ3ã€œ4ã‚·ãƒ¼ãƒ³ï¼‰', 'ç€ç‰©1ç€ï¼‹æ´‹è£…1ç€ï¼ˆ2ç€æ’®å½±ï¼‰', 'ãŠå­æ§˜ã®ãƒ˜ã‚¢ãƒ¡ã‚¤ã‚¯ãƒ»ç€ä»˜ã‘è¾¼ã¿', 'ğŸ‘˜ ãƒãƒã®è¨ªå•ç€ï¼‹ç€ä»˜ã‘è¾¼ã¿', 'â­ï¸ å…„å¼Ÿã‚‚ç€ç‰©ç€ç”¨å¯èƒ½', `â›©ï¸ ${info753.shrine}ãƒ­ã‚±ã§å®¶æ—å†™çœŸï¼ˆ1æ—¥ã§å®Œçµï¼‰`],
                urgency: 'ç§‹ã®ä¸ƒäº”ä¸‰ã‚·ãƒ¼ã‚ºãƒ³ã¯äºˆç´„ãŒåŸ‹ã¾ã‚Šã‚„ã™ããªã‚Šã¾ã™',
                proof: 'è¦ªå­ã§ç€ç‰©å§¿ã®è¨˜å¿µå†™çœŸãŒæ®‹ã›ã¾ã™'
              });

            } else {
              addRichMsg({
                gradient: 'linear-gradient(135deg, #4a90d9, #7ab8e8)',
                title: 'â›©ï¸ ä¸ƒäº”ä¸‰ ã‚¹ã‚¿ã‚¸ã‚ªï¼‹ãƒ­ã‚±',
                subtitle: 'Â¥35,000ã€œï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
                features: ['ğŸ’° æ˜æœ—ä¼šè¨ˆãƒ»å¤§æ‰‹ã®åŠé¡', '60ã‚«ãƒƒãƒˆï¼ˆ3ã€œ4ã‚·ãƒ¼ãƒ³ï¼‰', 'ç€ç‰©1ç€ï¼‹æ´‹è£…1ç€ï¼ˆ2ç€æ’®å½±ï¼‰', 'ãƒ˜ã‚¢ãƒ¡ã‚¤ã‚¯ãƒ»ç€ä»˜ã‘è¾¼ã¿', 'â­ï¸ å…„å¼Ÿã‚‚ç€ç‰©ç€ç”¨å¯èƒ½', `â›©ï¸ ${info753.shrine}ãƒ­ã‚±ã§å®¶æ—å†™çœŸï¼ˆ1æ—¥ã§å®Œçµï¼‰`],
                urgency: 'ç§‹ã®ä¸ƒäº”ä¸‰ã‚·ãƒ¼ã‚ºãƒ³ã¯äºˆç´„ãŒåŸ‹ã¾ã‚Šã‚„ã™ããªã‚Šã¾ã™',
                proof: 'ã‚¹ã‚¿ã‚¸ã‚ªâ†’ç¥ç¤¾â†’ãŠå‚ã‚ŠãŒ1æ—¥ã§å®Œçµ'
              });
            }
          });
        });
      } else {
        await addMsg('bot', 'å…„å¼Ÿæ’®å½±ã€ç´ æ•µã§ã™ã­ï¼\nå…„å¼Ÿã‚‚ç€ç‰©ãŒç€ã‚‰ã‚Œã‚‹ãƒ—ãƒ©ãƒ³ãŒã‚ã‚Šã¾ã™ã€‚');
        await addMsg('bot', `ğŸ‘˜ å…„å¼Ÿæ’®å½±ã«ã¤ã„ã¦
ã€ç„¡æ–™ã§å«ã¾ã‚Œã‚‹ã‚‚ã®ã€‘
â­ å…„å¼Ÿã®ç€ç‰©1ç€ãƒ¬ãƒ³ã‚¿ãƒ«
â­ å®¶æ—ãƒ»å…„å¼Ÿã¨ä¸€ç·’ã®ã‚«ãƒƒãƒˆ
ã€ã‚‚ã£ã¨æ®‹ã—ãŸã„ãªã‚‰ã€‘
ğŸ“¸ å…„å¼Ÿã‚½ãƒ­ã‚«ãƒƒãƒˆæœ‰ã‚Šã‚ªãƒ—ã‚·ãƒ§ãƒ³
ã€€+Â¥16,500ï¼ˆè¡£è£…2ç‚¹ãƒ»10ã‚«ãƒƒãƒˆè¿½åŠ ï¼‰
âš ï¸ ã‚¹ã‚¿ã‚¸ã‚ªï¼‹ãƒ­ã‚±ã®å ´åˆ
ã€€å…„å¼Ÿã®æ´‹è£…è¿½åŠ ã¯ã§ãã¾ã›ã‚“
ã€€ï¼ˆç€ç‰©ã®ã¿ã¨ãªã‚Šã¾ã™ï¼‰`, 600);
        addRichMsg({
          gradient: 'linear-gradient(135deg, #ff6b9d, #ff8fab)',
          title: 'ğŸ ä¸ƒäº”ä¸‰ï¼‹å…„å¼Ÿæ’®å½±',
          subtitle: 'Â¥35,000ã€œï¼ˆç¨åˆ¥ï¼‰â€»åœŸæ—¥ç¥+Â¥3,000',
          features: ['ğŸ’° æ˜æœ—ä¼šè¨ˆãƒ»å¤§æ‰‹ã®åŠé¡', '60ã‚«ãƒƒãƒˆæ’®å½±', 'ãƒ˜ã‚¢ãƒ¡ã‚¤ã‚¯ãƒ»ç€ä»˜ã‘è¾¼ã¿', 'â­ï¸ å…„å¼Ÿã‚‚ç€ç‰©ç€ç”¨å¯èƒ½', 'ğŸ‘˜ ã‚½ãƒ­ã‚«ãƒƒãƒˆæœ‰ã‚Šã‚ªãƒ—ã‚·ãƒ§ãƒ³ +Â¥16,500', 'å®¶æ—å…¨å“¡ã§ã®è¨˜å¿µå†™çœŸ'],
          proof: 'å…„å¼Ÿã®çµ†ã‚’å†™çœŸã«æ®‹ã™å¤§åˆ‡ãªæ©Ÿä¼š'
        });
      }
    });
  });
}

// --- ãã®ä»–ãƒ•ãƒ­ãƒ¼ ---
async function flowOther() {
  currentPlanType = 'other'; // ä¸€èˆ¬ç”¨äºˆç´„URL
  addStepIndicator('â€” Step 2: ãã®ä»–ã®æ’®å½± â€”');
  await addMsg('bot', 'ã©ã‚“ãªæ’®å½±ã§ã‚‚ãŠæ°—è»½ã«ã”ç›¸è«‡ãã ã•ã„ï¼');

  await addMsg('bot', `ã€å¤§æ‰‹ã‚¹ã‚¿ã‚¸ã‚ªç›¸å ´ã€‘
ã‚¹ã‚¿ã‚¸ã‚ªã‚¢ãƒªã‚¹: Â¥70,000~150,000

ã€hikarino studioã€‘
ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ã‚¹ã‚¿ã‚¸ã‚ªãƒ—ãƒ©ãƒ³: Â¥33,000
(å¤§æ‰‹ã®åŠé¡ä»¥ä¸‹!)
ğŸ’ ãƒ©ã‚¤ãƒˆãƒ—ãƒ©ãƒ³: Â¥40,000`, 800);

  addChoices([
    { label: 'ğŸ¤° ãƒã‚¿ãƒ‹ãƒ†ã‚£ãƒ•ã‚©ãƒˆ', value: 'maternity' },
    { label: 'ğŸ“ æˆäººå¼ãƒ»å…¥å­¦å’åœ’', value: 'event' },
    { label: 'ğŸ“ ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³æ’®å½±', value: 'location' },
    { label: 'ğŸ’¬ ç›¸è«‡ã—ãŸã„', value: 'consult' }
  ], async (choice) => {
    addStepIndicator('â€” Step 3: ã”æ¡ˆå†… â€”');
    if (choice === 'consult') {
      await addMsg('bot', 'ã©ã‚“ãªã“ã¨ã§ã‚‚ãŠæ°—è»½ã«ã©ã†ãï¼\nã‚¹ã‚¿ãƒƒãƒ•ãŒä¸å¯§ã«ãŠç­”ãˆã—ã¾ã™ã€‚');
    } else {
      await addMsg('bot', 'ã´ã£ãŸã‚Šã®ãƒ—ãƒ©ãƒ³ã‚’ã”ææ¡ˆã—ã¾ã™ã€‚\nè©³ã—ã„ã”å¸Œæœ›ã‚’ãŠèã‹ã›ãã ã•ã„ï¼');
    }
    addStepIndicator('âœ… ã‚¹ã‚¿ãƒƒãƒ•å¯¾å¿œã¸ç§»è¡Œ');
  });
}

let currentPlanType = 'other'; // ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³ or other

async function handleCTA(type) {
  if (type === 'reservation') {
    // ãƒ—ãƒ©ãƒ³ã«å¿œã˜ãŸäºˆç´„URLã«é·ç§»
    const reservationUrls = {
      newborn: 'https://docs.google.com/forms/d/e/1FAIpQLSc3SmhZFUmUb6jigSCQk-oGw8i1wa_nVB4DQSoYre_lqreunQ/viewform',
      other: 'https://select-type.com/rsv/?id=y9oX7prw0BA&c_id=250455'
    };
    window.open(reservationUrls[currentPlanType], '_blank');
  } else {
    await addMsg('user', 'ç›¸è«‡ã—ãŸã„');
    await addMsg('bot', 'ã‚‚ã¡ã‚ã‚“ã§ã™ï¼\n\næ’®å½±å†…å®¹ãƒ»è¡£è£…ãƒ»æ—¥ç¨‹ãªã©ã€ä½•ã§ã‚‚ãŠæ°—è»½ã«ã©ã†ãã€‚\nã‚¹ã‚¿ãƒƒãƒ•ãŒä¸å¯§ã«ãŠç­”ãˆã—ã¾ã™ã€‚ãƒãƒ£ãƒƒãƒˆæ¬„ã¸å†…å®¹ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚', 600);

    addStepIndicator('âœ… ã‚¹ã‚¿ãƒƒãƒ•å¯¾å¿œã¸ç§»è¡Œ');
  }
}

// =========================================
// ãƒªãƒã‚¤ãƒ³ãƒ‰æ©Ÿèƒ½
// =========================================
const scheduledReminders = {};

async function setReminder(dueDate, message, delayDays) {
  const reminderDate = new Date(dueDate);
  reminderDate.setDate(reminderDate.getDate() + delayDays);

  const reminderId = `reminder_${Date.now()}`;
  scheduledReminders[reminderId] = {
    date: reminderDate,
    message: message
  };

  // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜ï¼ˆæœ¬ç•ªã¯ã‚µãƒ¼ãƒãƒ¼å´ã§ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰
  localStorage.setItem('reminders', JSON.stringify(scheduledReminders));
}

async function sendScheduledReminder(reminderId) {
  const reminder = scheduledReminders[reminderId];
  if (reminder) {
    await addMsg('bot', reminder.message, 600);
    delete scheduledReminders[reminderId];
    localStorage.setItem('reminders', JSON.stringify(scheduledReminders));
  }
}

// å¦Šå¨ ä¸­ãƒ•ãƒ­ãƒ¼ã§ãƒªãƒã‚¤ãƒ³ãƒ‰è¨­å®š
async function setPregnancyReminders(dueDate) {
  // å‡ºç”£äºˆå®šæ—¥ã®2é€±é–“å‰
  await setReminder(dueDate, `å‡ºç”£äºˆå®šæ—¥ã¾ã§2é€±é–“ã¨ãªã‚Šã¾ã—ãŸ!
ä½“èª¿ã¯ã„ã‹ãŒã§ã™ã‹?
å‡ºç”£å¾Œã«ã¾ãŸã”é€£çµ¡ã„ãŸã—ã¾ã™ã­ğŸ¤°`, -14);

  // å‡ºç”£äºˆå®šæ—¥ã®7æ—¥å¾Œ
  await setReminder(dueDate, `ğŸ‰ ã”å‡ºç”£ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™!
ãƒ‹ãƒ¥ãƒ¼ãƒœãƒ¼ãƒ³æ’®å½±ã®ãƒ™ã‚¹ãƒˆã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¯
ç”Ÿå¾Œ7~21æ—¥ã§ã™ã€‚
ä½“èª¿ãŒè½ã¡ç€ã‹ã‚Œã¾ã—ãŸã‚‰
æ’®å½±æ—¥ã®ã”ç›¸è«‡ã‚’ã•ã›ã¦ãã ã•ã„ğŸ’`, 7);
}

function resetFlow() { chat.innerHTML = ''; startFlow(); }
startFlow();
</script>
</body>
</html>
